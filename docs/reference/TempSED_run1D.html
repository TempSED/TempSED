<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Dynamic solution of sediment temperature in one vertical Dimension. — TempSED_run1D • TempSED</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Dynamic solution of sediment temperature in one vertical Dimension. — TempSED_run1D"><meta property="og:description" content="TempSED_run1D calculates temperature in a vertical sediment column of 100 layers."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TempSED</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/TempSED.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Dynamic solution of sediment temperature in one vertical Dimension.</h1>

    <div class="hidden name"><code>TempSED_run1D.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>TempSED_run1D</code> calculates temperature in a vertical sediment column of 100 layers.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">TempSED_run1D</span> <span class="op">(</span>parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3600</span>, T_ini <span class="op">=</span> <span class="fl">10</span>, </span>
<span>               z_max <span class="op">=</span> <span class="fl">10</span>, dz_1 <span class="op">=</span> <span class="fl">1e-3</span>, </span>
<span>               Grid <span class="op">=</span> <span class="fu">setup.grid.1D</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>, dx.1 <span class="op">=</span> <span class="va">dz_1</span>, L <span class="op">=</span> <span class="va">z_max</span><span class="op">)</span>,</span>
<span>               porosity      <span class="op">=</span> <span class="fl">0.5</span>,   irrigation <span class="op">=</span> <span class="fl">0</span>, </span>
<span>               f_Waterheight <span class="op">=</span> <span class="fl">0</span>,     f_Watertemperature <span class="op">=</span> <span class="fl">10</span>, </span>
<span>               f_Airtemperature <span class="op">=</span> <span class="fl">10</span>, f_Airhumidity <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>               f_Pressure <span class="op">=</span> <span class="fl">101325</span>,   f_Solarradiation <span class="op">=</span> <span class="fl">100</span>, </span>
<span>               f_Windspeed <span class="op">=</span> <span class="fl">1</span>,       f_Cloudiness <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>               dependency_on_T <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>               sedpos <span class="op">=</span> <span class="cn">NULL</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, dtmax <span class="op">=</span> <span class="fl">3600</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-parms">parms<a class="anchor" aria-label="anchor" href="#arg-parms"></a></dt>
<dd><p>A list with parameter values. Available parameters can be listed using function TempSED_getparms. See details, and <a href="TempSED_getparms.html">TempSED_getparms</a>.</p></dd>

 <dt id="arg-z-max">z_max<a class="anchor" aria-label="anchor" href="#arg-z-max"></a></dt>
<dd><p>The total length of the vertical sediment column (z-axis), one number [m].</p></dd>

 <dt id="arg-dz-">dz_1<a class="anchor" aria-label="anchor" href="#arg-dz-"></a></dt>
<dd><p>Size of the first grid cell [m].
 The other grid cells will have exponentially changing sizes so that the total sediment length will be = <code>z_max</code>.
 There are 100 grid cells.</p></dd>

 <dt id="arg-grid">Grid<a class="anchor" aria-label="anchor" href="#arg-grid"></a></dt>
<dd><p>list with the specification of the one-dimensional grid; axis pointing downward. It should contain the following elements: <code>x.mid</code> with the positions in the middle of the grid cells (length 100); <code>x.int</code> with the positions at the grid interfaces (length 101); <code>dx</code> and <code>dx.aux</code> should contain the cell thickness (length 100), and the distance between the middle of the cells (length 101) respectively.</p></dd>

 <dt id="arg-t-ini">T_ini<a class="anchor" aria-label="anchor" href="#arg-t-ini"></a></dt>
<dd><p>Initial temperature distribution (at start of the run), [dgC].
 One number, a vector of length 100, a <code>function</code> that takes sediment depth as argument, or an object generated with <code>TempSED_run1D</code>.
 In the latter case, the final temperature values in this object will be used as initial values.</p></dd>

 <dt id="arg-times">times<a class="anchor" aria-label="anchor" href="#arg-times"></a></dt>
<dd><p>Output times for the dynamic run.</p></dd>

 <dt id="arg-porosity">porosity<a class="anchor" aria-label="anchor" href="#arg-porosity"></a></dt>
<dd><p>volumetric water content (volume water/volume bulk), [-].
  One number or a vector of length 101 (porosity defined at the box interfaces).
  Also allowed is a <code>function</code> that has as argument sediment depth (in m).</p></dd>

 <dt id="arg-irrigation">irrigation<a class="anchor" aria-label="anchor" href="#arg-irrigation"></a></dt>
<dd><p>The irrigation rate [/d], one value or a vector of length 100.
  Also allowed is a <code>function</code> that has as argument sediment depth (in m).</p></dd>

 <dt id="arg-f-waterheight">f_Waterheight<a class="anchor" aria-label="anchor" href="#arg-f-waterheight"></a></dt>
<dd><p>The height of the overlying water, [m].
 Either one value, a <code>function</code> that takes time as argument, or a two-columned matrix with (time, value).
 Note that in the latter case the time (first column) should embrace the output <code>times</code>. See details.</p></dd>

 <dt id="arg-f-watertemperature">f_Watertemperature<a class="anchor" aria-label="anchor" href="#arg-f-watertemperature"></a></dt>
<dd><p>The temperature of the overlying water, [dgC].
 Either one value, a <code>function</code> that takes time as argument, or a two-columned matrix with (time, value).
 Note that in the latter case the time (first column) should embrace the output <code>times</code>. See details.</p></dd>

 <dt id="arg-f-airtemperature">f_Airtemperature<a class="anchor" aria-label="anchor" href="#arg-f-airtemperature"></a></dt>
<dd><p>The temperature of the air, [dgC].
 Either one value, a <code>function</code> that takes time as argument, or a two-columned matrix with (time, value).
 Note that in the latter case the time (first column) should embrace the output <code>times</code>. See details.</p></dd>

 <dt id="arg-f-airhumidity">f_Airhumidity<a class="anchor" aria-label="anchor" href="#arg-f-airhumidity"></a></dt>
<dd><p>The humidity of the air, as a fraction of saturation [-], inbetween (0,1).
 Either one value, a <code>function</code> that takes time as argument, or a two-columned matrix with (time, value).
 Note that in the latter case the time (first column) should embrace the output <code>times</code>. See details.</p></dd>

 <dt id="arg-f-pressure">f_Pressure<a class="anchor" aria-label="anchor" href="#arg-f-pressure"></a></dt>
<dd><p>The atmospheric pressure, [Pa].
 Either one value, a <code>function</code> that takes time as argument, or a two-columned matrix with (time, value).
 Note that in the latter case the time (first column) should embrace the output <code>times</code>. See details.</p></dd>

 <dt id="arg-f-solarradiation">f_Solarradiation<a class="anchor" aria-label="anchor" href="#arg-f-solarradiation"></a></dt>
<dd><p>The shortwave radiation, [W/m2].
 Either one value, a <code>function</code> that takes time as argument, or a two-columned matrix with (time, value).
 Note that in the latter case the time (first column) should embrace the output <code>times</code>. See details.</p></dd>

 <dt id="arg-f-windspeed">f_Windspeed<a class="anchor" aria-label="anchor" href="#arg-f-windspeed"></a></dt>
<dd><p>The velocity of the wind, estimated 10m above the surface, [m/s].
 Either one value, a <code>function</code> that takes time as argument, or a two-columned matrix with (time, value).
 Note that in the latter case the time (first column) should embrace the output <code>times</code>. See details.</p></dd>

 <dt id="arg-f-cloudiness">f_Cloudiness<a class="anchor" aria-label="anchor" href="#arg-f-cloudiness"></a></dt>
<dd><p>The fraction of the sky covered by clouds [-], inbetween (0,1).
 Either one value, a <code>function</code> that takes time as argument, or a two-columned matrix with (time, value).
 Note that in the latter case the time (first column) should embrace the output <code>times</code>. See details.</p></dd>

 <dt id="arg-dependency-on-t">dependency_on_T<a class="anchor" aria-label="anchor" href="#arg-dependency-on-t"></a></dt>
<dd><p>if TRUE, will calculate water properties at each time step as a function of temperature (for testing)</p></dd>

 <dt id="arg-sedpos">sedpos<a class="anchor" aria-label="anchor" href="#arg-sedpos"></a></dt>
<dd><p>A vector of sediment depths (in m) at which temperature output is wanted.
 If not NULL, then the output matrix will contain an extra column for each value in sedpos, and which are called "Tsed_.." where .. is the value in <code>sedpos</code>.
 See first example.</p></dd>

 <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If <code>TRUE</code>, will write output to the screen in case the solver (<a href="https://rdrr.io/pkg/deSolve/man/vode.html" class="external-link">vode</a>) encountered problems.</p></dd>

  <dt id="arg-dtmax">dtmax<a class="anchor" aria-label="anchor" href="#arg-dtmax"></a></dt>
<dd><p>Maximum time step - setting this too high may lead to numerical instabilities.
  Too low timesteps will make the simulation very slow.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A matrix of class <code>TempSEDdyn</code> and <code>deSolve</code>, as generated by the solver from R-package <code>deSolve</code> (ode.1D).</p>
<p>It contains several output columns, the first is <code>time</code>, followed by 100 columns that represent the temperature in the sediment layers. The other variables are zero-dimensional variables - use <code><a href="TempSED_getvars.html">TempSED_get0Dvars()</a></code> to see what they represent.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Karline Soetaert</p>
    </div>
    <div id="details">
    <h2>Details</h2>


<p>The **parameters** that can be specified with argument <code>parms</code> are:</p>
<ul><li><p><code>em_air, em_sediment</code> Emissivity of the air (em_air) and  emissivity of Water/sediment (em_sediment); unitless.</p></li>
<li><p><code>stanton, dalton</code> Transfer coeff for sensible heat (stanton) and for latent heat (dalton); unitless.</p></li>
<li><p><code>density_water, density_solid</code> Water density (dens_water) and sediment dry density (dens_solid); [kg/m3].</p></li>
<li><p><code>cp_water, cp_solid</code> Specific heat capacity of the water (cp_water) and of solid sediment (cp_Solid) [J/kg/dgC].</p></li>
<li><p><code>tc_water, tc_solid</code> The thermal conductivity of the water (tc_water) and of the solid sediment (tc_solid) [W/m/dg].</p></li>
<li><p><code>albedo_water, albedo_sediment</code> The part of the shortwave radiation refracted by the overlying water (albedo_water), or the sediment (albedo_sediment), one number, inbetween (0,1) [-].</p></li>
<li><p><code>kd_water, kd_sediment</code> The light extinction coefficient in the overlying water (kd_water), or the bulk sediment (kd_sediment) [/m].</p></li>
</ul><p>==========</p>
<p>The **units** of the temperature model are [seconds], [m] and degree Celsius.</p>
<p>==========</p>
<p>The **sediment column** is subdivided in 100 layers, the total length is defined by argument <code>z_max</code>,
  the size of the first box is defined by argument <code>dz_1</code>.
  The size of the boxes increases exponentially.</p>
<p>==========</p>
<p>The **forcing functions** <code>f_Waterheight, f_Watertemperature, f_Airtemperature,
  f_Airhumidity, f_Pressure, f_Solarradiation, f_Windspeed,  f_Cloudiness</code> can
  be prescribed either as a constant, as a function, or as a data series.</p>
<p>Forcing functions imposed by a <code>data series</code> should be a two-columned
  matrix with times (first column) and values (second column).
  The values should be in the correct units.
  The time series should embrace the requested output times (argument <code>times</code>).</p>
<p>When prescribed by a <code>function</code>, the function should have as argument "time"
  and return one value, (in the correct units). Note that, before calling the fortran code,
  the forcing function will be evaluated for at most 10000 time values.
  Thus, if fF is the forcing function, then it will be evaluated as <code>fF(ftimes)</code>, where
  <code>ftimes = times[1]:times[length(times)]</code> in case <code>diff(range(times)) &lt; 1e4</code> or
  <code>ftimes &lt;- seq(from=times[1], to=times[length(times)], length.out=10000)</code>.
  If this is too detailed or not detailed enough, then it is advised to pass the
  forcing as a data series rather than as a function.</p>
<p>==========</p>
<p>The model is implemented in fortran for speed; the integration is done with *vode* from deSolve. Due to forcing functions that may change very rapidly, this model can become difficiult to solve, even with vode. If that happens, set <code>dtmax</code> to a lower value, OR smooth the forcings.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>to be added</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="TempSED_getvars.html">TempSED_get0Dvars</a></code>.
  <code><a href="TempSED_getparms.html">TempSED_getparms</a></code>.
  <code><a href="TempSED_plot.html">plot.TempSEDdyn</a></code>.
  <code><a href="flux_heat.html">flux_heat</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Show the parameter settings</span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="TempSED_getparms.html">TempSED_getparms</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     parms    units</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S                 35.0000        -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> em_air             0.8000        -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> em_sediment        0.9500        -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> albedo_water       0.0500        -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> albedo_sediment    0.1500        -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kd_water           1.0000       /m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kd_sediment     1000.0000       /m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cp_water        3994.0000 J/kg/dgC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cp_solid        1000.0000 J/kg/dgC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tc_water           0.6000   W/m/dg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tc_solid           2.1000   W/m/dg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> density_water   1024.0000    kg/m3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> density_solid   2500.0000    kg/m3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stanton            0.0010        -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dalton             0.0014        -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                   description</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S                         Salinity of water and bulk sediment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> em_air                                      Emissivity of air</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> em_sediment                      Emissivity of Water/sediment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> albedo_water                    Part light refracted by water</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> albedo_sediment              Part light refracted by sediment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kd_water                  Light attenuation coefficient water</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kd_sediment     Light attenuation coefficient (bulk) sediment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cp_water                         Specific heat capacity water</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cp_solid                Specific heat capacity solid sediment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tc_water                        Thermal conductivity of water</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tc_solid                        Thermal conductivity of solid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> density_water                      Reference seawater density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> density_solid                            Sediment dry density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stanton                      Transfer coeff for sensible heat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dalton                         Transfer coeff for latent heat</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#==========================================================</span></span></span>
<span class="r-in"><span><span class="co"># Application 1: SEASONAL VARIATION - EXPOSED TO AIR</span></span></span>
<span class="r-in"><span><span class="co">#==========================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Forcing functions for air temperature (dgC) </span></span></span>
<span class="r-in"><span><span class="co"># and solar radiation (W/m2), yearly period</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fAirTempYr</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span>                            </span></span>
<span class="r-in"><span>                    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">15</span> <span class="op">+</span> <span class="fl">15</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">86400</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fSolarRadYr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span>                           </span></span>
<span class="r-in"><span>                    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">150</span> <span class="op">+</span> <span class="fl">120</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">86400</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span>   </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1. spinup run</span></span></span>
<span class="r-in"><span><span class="co"># ----------------</span></span></span>
<span class="r-in"><span><span class="va">times</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">86400</span>, by <span class="op">=</span> <span class="fl">86400</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="va">ToutIni</span> <span class="op">&lt;-</span> <span class="fu">TempSED_run1D</span><span class="op">(</span></span></span>
<span class="r-in"><span>                   T_ini            <span class="op">=</span> <span class="fl">10</span>, </span></span>
<span class="r-in"><span>                   times            <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                   f_Airtemperature <span class="op">=</span> <span class="va">fAirTempYr</span>,</span></span>
<span class="r-in"><span>                   f_Solarradiation <span class="op">=</span> <span class="va">fSolarRadYr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.10    0.00    0.09 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2. final run </span></span></span>
<span class="r-in"><span><span class="co"># ----------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># request output at 1cm, 1dm, and 1m (sedpos).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ToutYr</span>  <span class="op">&lt;-</span> <span class="fu">TempSED_run1D</span><span class="op">(</span></span></span>
<span class="r-in"><span>                  T_ini            <span class="op">=</span> <span class="va">ToutIni</span>, </span></span>
<span class="r-in"><span>                  times            <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                  f_Airtemperature <span class="op">=</span> <span class="va">fAirTempYr</span>,</span></span>
<span class="r-in"><span>                  f_Solarradiation <span class="op">=</span> <span class="va">fSolarRadYr</span>, </span></span>
<span class="r-in"><span>                  sedpos           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>            <span class="co"># arrangement of the figures</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># time-depth plot</span></span></span>
<span class="r-in"><span><span class="co"># ----------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">image2D</span><span class="op">(</span><span class="va">ToutYr</span>,                 mfrow <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>  <span class="co"># mfrow=NULL prevents mfrow to be reset</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-in"><span><span class="fu">image2D</span><span class="op">(</span><span class="va">ToutYr</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0</span><span class="op">)</span>, mfrow <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>  <span class="co"># zoom in </span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'x' is NULL so the result will be NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># temporal plots</span></span></span>
<span class="r-in"><span><span class="co"># ----------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span>      <span class="op">(</span><span class="va">ToutYr</span>, </span></span>
<span class="r-in"><span>           which <span class="op">=</span> <span class="st">"Heatflux_total"</span>,                             </span></span>
<span class="r-in"><span>           mfrow <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="TempSED_plot.html">matplot0D</a></span><span class="op">(</span><span class="va">ToutYr</span>, </span></span>
<span class="r-in"><span>          which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tsed_0.01"</span>, <span class="st">"Tsed_0.1"</span>, <span class="st">"Tsed_1"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>          lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>, mfrow <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="TempSED_run1D-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#==========================================================</span></span></span>
<span class="r-in"><span><span class="co"># Application 2: SEASONAL VARIATION - SUBMERGED</span></span></span>
<span class="r-in"><span><span class="co">#==========================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Forcing functions for water temperature; yearly period</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fWaterTempYr</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> </span></span>
<span class="r-in"><span>                     <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">+</span> <span class="fl">8</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">86400</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">86400</span>, by <span class="op">=</span> <span class="fl">86400</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ToutYr2</span> <span class="op">&lt;-</span> <span class="fu">TempSED_run1D</span><span class="op">(</span></span></span>
<span class="r-in"><span>                   T_ini              <span class="op">=</span> <span class="fl">10</span>, </span></span>
<span class="r-in"><span>                   times              <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                   f_Watertemperature <span class="op">=</span> <span class="va">fWaterTempYr</span>,</span></span>
<span class="r-in"><span>                   f_Waterheight      <span class="op">=</span> <span class="fl">1</span>,    <span class="co"># constant water height</span></span></span>
<span class="r-in"><span>                   f_Solarradiation   <span class="op">=</span> <span class="va">fSolarRadYr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">image2D</span><span class="op">(</span><span class="va">ToutYr2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="TempSED_run1D-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#==========================================================</span></span></span>
<span class="r-in"><span><span class="co"># Application 3: DIURNAL VARIATION + tides</span></span></span>
<span class="r-in"><span><span class="co">#==========================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># tide forcing</span></span></span>
<span class="r-in"><span><span class="va">fTides</span>     <span class="op">&lt;-</span> <span class="fu"><a href="TempSEDfunctions.html">trunc_function</a></span><span class="op">(</span>duration <span class="op">=</span> <span class="fl">3</span><span class="op">*</span><span class="fl">3600</span> ,    <span class="co"># time submerged, [s]</span></span></span>
<span class="r-in"><span>                             period   <span class="op">=</span> <span class="fl">12.4</span><span class="op">*</span><span class="fl">3600</span>,  <span class="co"># tidal period, [s]</span></span></span>
<span class="r-in"><span>                             max      <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>          <span class="co"># max water height, [m]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># radiation forcing</span></span></span>
<span class="r-in"><span><span class="va">Rad0</span>       <span class="op">&lt;-</span> <span class="fl">150</span>    <span class="co"># [W/m2] dayly radiation</span></span></span>
<span class="r-in"><span><span class="va">DL</span>         <span class="op">&lt;-</span> <span class="fl">12</span>     <span class="co"># daylength - Hours</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fRad.day0</span>  <span class="op">&lt;-</span> <span class="fu"><a href="TempSEDfunctions.html">trunc_function</a></span><span class="op">(</span>duration <span class="op">=</span> <span class="va">DL</span><span class="op">*</span><span class="fl">3600</span>, </span></span>
<span class="r-in"><span>                             average  <span class="op">=</span> <span class="va">Rad0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># air temperatureforcing</span></span></span>
<span class="r-in"><span><span class="va">Tmp0</span>       <span class="op">&lt;-</span> <span class="fl">15</span>     <span class="co"># dgC</span></span></span>
<span class="r-in"><span><span class="va">fTmp.day0</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> </span></span>
<span class="r-in"><span>                  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">Tmp0</span>  <span class="op">+</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">86400</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># water temperature forcing</span></span></span>
<span class="r-in"><span><span class="va">Twat0</span>      <span class="op">&lt;-</span> <span class="fl">10</span>     <span class="co"># dgC</span></span></span>
<span class="r-in"><span><span class="va">fTwat.day0</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> </span></span>
<span class="r-in"><span>                  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">Twat0</span> <span class="op">+</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">86400</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model run</span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">3</span><span class="op">*</span><span class="fl">86400</span>, by <span class="op">=</span> <span class="fl">360</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Tout.day0</span> <span class="op">&lt;-</span> <span class="fu">TempSED_run1D</span><span class="op">(</span></span></span>
<span class="r-in"><span>                     T_ini              <span class="op">=</span> <span class="va">ToutYr</span>, </span></span>
<span class="r-in"><span>                     times              <span class="op">=</span> <span class="va">times</span>,</span></span>
<span class="r-in"><span>                     f_Airtemperature   <span class="op">=</span> <span class="va">fTmp.day0</span>, </span></span>
<span class="r-in"><span>                     f_Waterheight      <span class="op">=</span> <span class="va">fTides</span>,</span></span>
<span class="r-in"><span>                     f_Watertemperature <span class="op">=</span> <span class="va">fTwat.day0</span>, </span></span>
<span class="r-in"><span>                     f_Solarradiation   <span class="op">=</span> <span class="va">fRad.day0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">image2D</span><span class="op">(</span><span class="va">Tout.day0</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="TempSED_run1D-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Karline Soetaert.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

