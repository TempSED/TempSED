<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TempSED: modelling temperature in aquatic sediments • TempSED</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="TempSED: modelling temperature in aquatic sediments">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TempSED</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/TempSED.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>TempSED: modelling temperature in aquatic
sediments</h1>
                        <h4 data-toc-skip class="author">Karline
Soetaert, Lubos Polerecky, Qi Liu</h4>
            
            <h4 data-toc-skip class="date">first version: 1-4-2021</h4>
      

      <div class="hidden name"><code>TempSED.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      The R-package TempSED contains functions to model temperature
      variations in aquatic sediments.
    </div>
    
<div class="section level2">
<h2 id="the-tempsed-r-package">the TempSED R-package<a class="anchor" aria-label="anchor" href="#the-tempsed-r-package"></a>
</h2>
<p>The R-package <em>TempSED</em> contains functions and datasets to
model temperature variations in aquatic sediments.</p>
<div class="section level3">
<h3 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h3>
<p>The function to run the temperature models, in one (vertical)
dimension is:</p>
<pre><code>[1] "TempSED_run1D"</code></pre>
<p>The functions to obtain settings (0D, 1D, state variables, grid
information, parameter settings), of the temperature models are:</p>
<pre><code>[1] "TempSED_get0Dvars" "TempSED_get1Dvars" "TempSED_getdepth" 
[4] "TempSED_getdx"     "TempSED_getgrid"   "TempSED_getirr"   
[7] "TempSED_getparms"  "TempSED_getpor"    "TempSED_getstates"</code></pre>
<p>The functions to calculate properties of the air, or bulk sediment,
or water are:</p>
<pre><code>[1] "air_cp"         "air_density"    "air_humidity"   "air_properties"
[5] "air_tc"         "air_td"         "air_vapor"     </code></pre>
<pre><code>[1] "bulk_cp"         "bulk_density"    "bulk_properties" "bulk_tc"        
[5] "bulk_td"        </code></pre>
<pre><code>[1] "water_cp"         "water_density"    "water_lh"         "water_properties"
[5] "water_tc"         "water_td"        </code></pre>
<p>The functions to calculate heat and water fluxes with the air:</p>
<pre><code>[1] "flux_backradiation" "flux_evaporation"   "flux_heat"         
[4] "flux_latent"        "flux_sensible"     </code></pre>
<p>Other minor functions are:</p>
<ul>
<li>
<em>trunc_function</em> creates truncated sine functions,</li>
<li>
<em>image2D</em>, <em>matplot0D</em>, <em>matplot1D</em>,
<em>plot</em>: utility functions for plotting.</li>
</ul>
</div>
<div class="section level3">
<h3 id="data-sets">Data sets<a class="anchor" aria-label="anchor" href="#data-sets"></a>
</h3>
<p>There are several data sets to model the temperature of the
Oosterschelde (a marine bay in the Netherlands)</p>
<ul>
<li>
<em>ForcingOS</em> contains forcing function data to run the
Oostereschelde sediment temperature model,</li>
<li>
<em>DataOS</em> contains observed data,</li>
<li>
<em>InitTempOS</em> contains an initial temperature profile for the
Oosterschelde temperature model.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="properties-of-the-air">Properties of the air<a class="anchor" aria-label="anchor" href="#properties-of-the-air"></a>
</h2>
<div class="section level3">
<h3 id="implementation-in-r">implementation in R<a class="anchor" aria-label="anchor" href="#implementation-in-r"></a>
</h3>
<p>Function <em>air_properties</em> calculates:</p>
<ul>
<li>the air humidity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mspace width="0.222em"></mspace><mi>w</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>r</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mi>g</mi><mspace width="0.222em"></mspace><mi>a</mi><mi>i</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">kg~water(kg~air)^{-1}</annotation></semantics></math>),</li>
<li>the air density
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mspace width="0.222em"></mspace><msup><mi>m</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">kg~m^{-3}</annotation></semantics></math>)
and</li>
<li>the vapor pressure
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">Pa</annotation></semantics></math>)
of the air.</li>
</ul>
<p>It is defined as:</p>
<pre><code><span><span class="fu"><a href="../reference/air_properties.html">air_properties</a></span>  <span class="op">(</span>T_air <span class="op">=</span> <span class="fl">10</span>, P <span class="op">=</span> <span class="fl">101325</span>, Qrel <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> </span>
<span> </span></code></pre>
<pre><code>  names mean.values           description units
1 T_air       10.00       air temperature   dgC
2     P   101325.00          air pressure    Pa
3  Qrel        0.01 relative air humidity     -</code></pre>
<p>The function returns a list that has a description of the output and
the parameter settings in its attributes:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="../reference/air_properties.html">air_properties</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">humidity</th>
<th align="right">density</th>
<th align="right">vapor</th>
<th align="right">cp_air</th>
<th align="right">tc_air</th>
<th align="right">td</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">7.56e-05</td>
<td align="right">1.246587</td>
<td align="right">12.26406</td>
<td align="right">1007.024</td>
<td align="right">0.0249254</td>
<td align="right">1.99e-05</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="fu"><a href="../reference/air_properties.html">air_properties</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">description</span></span></code></pre></div>
<pre><code>     names                   description   units
1 humidity  specific humidity of the air   kg/kg
2  density                   air density   kg/m3
3    vapor         vapor pressure of air      Pa
4   cp_air specific heat capacity of air J/kg/dg
5   td_air   thermal conductivity of air  W/m/dg
6   tc_air    thermal diffusivity of air    m2/s</code></pre>
<p>It can be called with a vector of input values. In this case, the
parameter attribute will contain the mean of the inputs.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/air_properties.html">air_properties</a></span><span class="op">(</span>T_air<span class="op">=</span><span class="fl">10</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">AP</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">humidity</th>
<th align="right">density</th>
<th align="right">vapor</th>
<th align="right">cp_air</th>
<th align="right">tc_air</th>
<th align="right">td</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">7.56e-05</td>
<td align="right">1.246587</td>
<td align="right">12.26406</td>
<td align="right">1007.024</td>
<td align="right">0.0249254</td>
<td align="right">1.99e-05</td>
</tr>
<tr class="even">
<td align="right">8.09e-05</td>
<td align="right">1.242196</td>
<td align="right">13.11049</td>
<td align="right">1007.028</td>
<td align="right">0.0250047</td>
<td align="right">2.00e-05</td>
</tr>
<tr class="odd">
<td align="right">8.64e-05</td>
<td align="right">1.237836</td>
<td align="right">14.00793</td>
<td align="right">1007.034</td>
<td align="right">0.0250838</td>
<td align="right">2.01e-05</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="dependencies-on-external-conditions">Dependencies on external conditions<a class="anchor" aria-label="anchor" href="#dependencies-on-external-conditions"></a>
</h3>
<p>The dependency of the air properties on varying air temperature,
humidity and atmospheric pressure are estimated:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T.seq</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>,            length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">Q.seq</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,  <span class="fl">1</span>,            length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">P.seq</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">101325</span>, <span class="fl">101325</span><span class="op">*</span><span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Dtq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">T.seq</span>, </span>
<span>             Y   <span class="op">=</span> <span class="va">Q.seq</span>, </span>
<span>             FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Ta</span>, <span class="va">Q</span><span class="op">)</span> </span>
<span>               <span class="fu"><a href="../reference/air_properties.html">air_properties</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">Ta</span>, Qrel <span class="op">=</span> <span class="va">Q</span><span class="op">)</span><span class="op">$</span><span class="va">density</span><span class="op">)</span></span>
<span><span class="va">Dtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">T.seq</span>, </span>
<span>             Y   <span class="op">=</span> <span class="va">P.seq</span>, </span>
<span>             FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Ta</span>, <span class="va">P</span><span class="op">)</span> </span>
<span>               <span class="fu"><a href="../reference/air_properties.html">air_properties</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">Ta</span>, P <span class="op">=</span> <span class="va">P</span><span class="op">)</span><span class="op">$</span><span class="va">density</span><span class="op">)</span></span>
<span><span class="va">Vtq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">T.seq</span>, </span>
<span>             Y   <span class="op">=</span> <span class="va">Q.seq</span>, </span>
<span>             FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Ta</span>, <span class="va">Q</span><span class="op">)</span> </span>
<span>               <span class="fu"><a href="../reference/air_properties.html">air_properties</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">Ta</span>, Qrel <span class="op">=</span> <span class="va">Q</span><span class="op">)</span><span class="op">$</span><span class="va">vapor</span><span class="op">)</span></span>
<span><span class="va">Vtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">T.seq</span>, </span>
<span>             Y   <span class="op">=</span> <span class="va">P.seq</span>, </span>
<span>             FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Ta</span>, <span class="va">P</span><span class="op">)</span> </span>
<span>               <span class="fu"><a href="../reference/air_properties.html">air_properties</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">Ta</span>, P <span class="op">=</span> <span class="va">P</span><span class="op">)</span><span class="op">$</span><span class="va">vapor</span><span class="op">)</span></span>
<span><span class="va">Htq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">T.seq</span>, </span>
<span>             Y   <span class="op">=</span> <span class="va">Q.seq</span>, </span>
<span>             FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Ta</span>, <span class="va">Q</span><span class="op">)</span> </span>
<span>               <span class="fu"><a href="../reference/air_properties.html">air_properties</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">Ta</span>, Qrel <span class="op">=</span> <span class="va">Q</span><span class="op">)</span><span class="op">$</span><span class="va">humidity</span><span class="op">)</span></span>
<span><span class="va">Htp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">T.seq</span>, </span>
<span>             Y   <span class="op">=</span> <span class="va">P.seq</span>, </span>
<span>             FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Ta</span>, <span class="va">P</span><span class="op">)</span> </span>
<span>               <span class="fu"><a href="../reference/air_properties.html">air_properties</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">Ta</span>, P <span class="op">=</span> <span class="va">P</span><span class="op">)</span><span class="op">$</span><span class="va">humidity</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span>, oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">Dtq</span>, x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">Q.seq</span>, </span>
<span>        contour <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"density"</span>, xlab <span class="op">=</span> <span class="st">"T_air, dgC"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Qrel, -"</span>, clab <span class="op">=</span> <span class="st">"kg/m3"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">Vtq</span>, x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">Q.seq</span>, </span>
<span>        contour<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"vapor pressure"</span>, xlab <span class="op">=</span> <span class="st">"T_air, dgC"</span>,  </span>
<span>        ylab <span class="op">=</span> <span class="st">"Qrel, -"</span>, clab <span class="op">=</span> <span class="st">"Pa"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">Htq</span>, x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">Q.seq</span>, </span>
<span>        contour<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"humidity"</span>, xlab <span class="op">=</span> <span class="st">"T_air, dgC"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Qrel, -"</span>, clab <span class="op">=</span> <span class="st">"kg/kg"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">Dtp</span>, x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">P.seq</span><span class="op">/</span><span class="fl">1000</span>, </span>
<span>        contour<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"density"</span>, xlab <span class="op">=</span> <span class="st">"T_air, dgC"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"P, KPa"</span>, clab <span class="op">=</span> <span class="st">"kg/m3"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">Vtp</span>, x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">P.seq</span><span class="op">/</span><span class="fl">1000</span>, </span>
<span>        contour<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"vapor pressure"</span>, xlab <span class="op">=</span> <span class="st">"T_air, dgC"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"P, KPa"</span>, clab <span class="op">=</span> <span class="st">"Pa"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">Htp</span>, x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">P.seq</span><span class="op">/</span><span class="fl">1000</span>, </span>
<span>        contour <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"humidity"</span>, xlab <span class="op">=</span> <span class="st">"T_air, dgC"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"P, KPa"</span>, clab <span class="op">=</span> <span class="st">"kg/kg"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>outer <span class="op">=</span> <span class="cn">TRUE</span>, side <span class="op">=</span> <span class="fl">3</span>, <span class="st">"air properties"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="reference-comparisons">Reference comparisons<a class="anchor" aria-label="anchor" href="#reference-comparisons"></a>
</h3>
<p>We compare the output of the function <em>air_properties</em> with a
set of reference values, for which the following sources were used:</p>
<ul>
<li>dry Air density (kg/m3): <a href="http://www.engineerstudent.co.uk/density_of_air.php" class="external-link uri">http://www.engineerstudent.co.uk/density_of_air.php</a>
</li>
<li>saturated Pressure (Pa): from <a href="https://en.wikipedia.org/wiki/Vapour_pressure_of_water" class="external-link uri">https://en.wikipedia.org/wiki/Vapour_pressure_of_water</a>
</li>
<li>saturated humidity (kgWater/kgAir): from <a href="https://www.engineeringtoolbox.com/humidity-ratio-air-d_686.html" class="external-link uri">https://www.engineeringtoolbox.com/humidity-ratio-air-d_686.html</a>
</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">airSat.ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span> temp  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span>
<span> vapor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.003767</span>, <span class="fl">0.005387</span>, <span class="fl">0.007612</span>, <span class="fl">0.01062</span>, </span>
<span>           <span class="fl">0.014659</span>, <span class="fl">0.019826</span>, <span class="fl">0.027125</span><span class="op">)</span>, <span class="co">#kg/kg</span></span>
<span> P     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6113</span>, <span class="fl">0.8726</span>, <span class="fl">1.2281</span>, <span class="fl">1.7056</span>, </span>
<span>           <span class="fl">2.3388</span>, <span class="fl">3.1690</span>, <span class="fl">4.2455</span><span class="op">)</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span> <span class="co"># Pa</span></span></code></pre></div>
<p>The air properties are estimated for a sequence of temperatures, and
for air that is saturated with water (<em>Qrel=1</em>) or that is dry
(<em>Qrel=0</em>).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T.seq</span>   <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">30</span></span>
<span></span>
<span><span class="va">Air.sat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="va">T.seq</span>, </span>
<span>                      <span class="fu"><a href="../reference/air_properties.html">air_properties</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">T.seq</span>, Qrel <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Air.dry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="va">T.seq</span>, </span>
<span>                      <span class="fu"><a href="../reference/air_properties.html">air_properties</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">T.seq</span>, Qrel <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">T.seq</span>, <span class="va">Air.sat</span><span class="op">$</span><span class="va">vapor</span>, </span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Saturated vapor pressure"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Air temperature"</span>, ylab <span class="op">=</span> <span class="st">"Pa"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">airSat.ref</span><span class="op">$</span><span class="va">temp</span>, <span class="va">airSat.ref</span><span class="op">$</span><span class="va">P</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">T.seq</span>, <span class="va">Air.sat</span><span class="op">$</span><span class="va">humidity</span>, </span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Saturated humidity"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Air temperature"</span>, ylab <span class="op">=</span> <span class="st">"kg/kg"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">airSat.ref</span><span class="op">$</span><span class="va">temp</span>, <span class="va">airSat.ref</span><span class="op">$</span><span class="va">vapor</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">T.seq</span>, <span class="va">Air.dry</span><span class="op">$</span><span class="va">density</span>, </span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Dry air density"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Air temperature"</span>, ylab <span class="op">=</span> <span class="st">"kg/m3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">airDry.ref</span><span class="op">$</span><span class="va">temp</span>, <span class="va">airDry.ref</span><span class="op">$</span><span class="va">density</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="properties-of-the-water">Properties of the water<a class="anchor" aria-label="anchor" href="#properties-of-the-water"></a>
</h2>
<div class="section level3">
<h3 id="implementation-in-r-1">implementation in R<a class="anchor" aria-label="anchor" href="#implementation-in-r-1"></a>
</h3>
<p>Function <em>water_properties</em> calculates:</p>
<ul>
<li>the density of the water
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mspace width="0.222em"></mspace><msup><mi>m</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">kg~m^{-3}</annotation></semantics></math>),</li>
<li>the specific heat capacity of the water
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mspace width="0.222em"></mspace><mi>k</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mspace width="0.222em"></mspace><mi>o</mi></msup><msup><mi>K</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">J~kg^{-1}~^oK^{-1}</annotation></semantics></math>)
and</li>
<li>the thermal diffusivity of the water
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mn>2</mn></msup><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">m^2 s^{-1}</annotation></semantics></math>)
.</li>
</ul>
<p>It is defined as:</p>
<pre><code><span><span class="fu"><a href="../reference/water_properties.html">water_properties</a></span>  <span class="op">(</span>T_water <span class="op">=</span> <span class="fl">20</span>, S <span class="op">=</span> <span class="fl">30</span>, P <span class="op">=</span> <span class="fl">101325</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span>
<span> </span></code></pre>
<pre><code>    names mean.values       description units
1 T_water          20 water temperature   dgC
2       S          30                 S     -
3       P      101325          pressure    Pa</code></pre>
<p>The function returns a list that has a description of the output and
the parameter settings in its attributes:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/water_properties.html">water_properties</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>  cp_water density_water     td_water  tc_water lh_water
1 4024.879      1020.953 1.464848e-07 0.6019367  2380049</code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="fu"><a href="../reference/water_properties.html">water_properties</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"description"</span>, <span class="st">"parameters"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>$description
          names                          description   units
1 density_water                     density of water   kg/m3
2      cp_water      specific heat capacity of water J/kg/dg
3      td_water         thermal diffusivity of water    m2/s
4      tc_water        thermal conductivity of water  W/m/dg
5      lh_water latent heat of vaporization of water    J/kg

$parameters
    names mean.values       description units
1 T_water          20 water temperature   dgC
2       S          30                 S     -
3       P      101325          pressure    Pa</code></pre>
<p>It can be called with a vector of input values. In this case, the
parameter attribute will contain the mean of the inputs.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/water_properties.html">water_properties</a></span><span class="op">(</span>T_water <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">WP</span></span></code></pre></div>
<pre><code>  cp_water density_water    td_water  tc_water lh_water
1 4022.215      1023.051 1.42567e-07 0.5866534  2403009
2 4022.491      1022.885 1.42968e-07 0.5882486  2400713
3 4022.765      1022.709 1.43367e-07 0.5898289  2398418</code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">WP</span><span class="op">)</span><span class="op">$</span><span class="va">description</span></span></code></pre></div>
<pre><code>          names                          description   units
1 density_water                     density of water   kg/m3
2      cp_water      specific heat capacity of water J/kg/dg
3      td_water         thermal diffusivity of water    m2/s
4      tc_water        thermal conductivity of water  W/m/dg
5      lh_water latent heat of vaporization of water    J/kg</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">WP</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span></span></code></pre></div>
<pre><code>    names mean.values       description units
1 T_water          11 water temperature   dgC
2       S          30                 S     -
3       P      101325          pressure    Pa</code></pre>
</div>
<div class="section level3">
<h3 id="dependencies-on-external-conditions-1">Dependencies on external conditions<a class="anchor" aria-label="anchor" href="#dependencies-on-external-conditions-1"></a>
</h3>
<p>The dependency of the water properties on varying water temperature,
salinity and atmospheric pressure are estimated:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T.seq</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>,      to <span class="op">=</span> <span class="fl">30</span>,       length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">S.seq</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>,      to <span class="op">=</span> <span class="fl">40</span>,       length.out <span class="op">=</span> <span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">P.seq</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">101325</span>, to <span class="op">=</span> <span class="fl">101325</span><span class="op">*</span><span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Dtq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">S.seq</span>, </span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">S</span><span class="op">)</span> </span>
<span>                    <span class="fu"><a href="../reference/water_properties.html">water_properties</a></span><span class="op">(</span>T_water <span class="op">=</span> <span class="va">T.seq</span>, S <span class="op">=</span> <span class="va">S</span><span class="op">)</span><span class="op">$</span><span class="va">density</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Dtp</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">P.seq</span>, </span>
<span>               FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">P</span><span class="op">)</span> </span>
<span>                     <span class="fu"><a href="../reference/water_properties.html">water_properties</a></span><span class="op">(</span>T_water <span class="op">=</span> <span class="va">T.seq</span>, P <span class="op">=</span> <span class="va">P</span><span class="op">)</span><span class="op">$</span><span class="va">density</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CPtq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">S.seq</span>, </span>
<span>               FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">S</span><span class="op">)</span> </span>
<span>                     <span class="fu"><a href="../reference/water_properties.html">water_properties</a></span><span class="op">(</span>T_water <span class="op">=</span> <span class="va">T.seq</span>, S <span class="op">=</span> <span class="va">S</span><span class="op">)</span><span class="op">$</span><span class="va">cp_water</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CPtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">P.seq</span>, </span>
<span>               FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">P</span><span class="op">)</span> </span>
<span>                     <span class="fu"><a href="../reference/water_properties.html">water_properties</a></span><span class="op">(</span>T_water <span class="op">=</span> <span class="va">T.seq</span>, P <span class="op">=</span> <span class="va">P</span><span class="op">)</span><span class="op">$</span><span class="va">cp_water</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TDtq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">S.seq</span>, </span>
<span>               FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">S</span><span class="op">)</span> </span>
<span>                     <span class="fu"><a href="../reference/water_properties.html">water_properties</a></span><span class="op">(</span>T_water <span class="op">=</span> <span class="va">T.seq</span>, S <span class="op">=</span> <span class="va">S</span><span class="op">)</span><span class="op">$</span><span class="va">td_water</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TDtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="va">P.seq</span>, </span>
<span>               FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">P</span><span class="op">)</span> </span>
<span>                     <span class="fu"><a href="../reference/water_properties.html">water_properties</a></span><span class="op">(</span>T_water <span class="op">=</span> <span class="va">T.seq</span>, P <span class="op">=</span> <span class="va">P</span><span class="op">)</span><span class="op">$</span><span class="va">td_water</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span>, oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">Dtq</span>,  x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">S.seq</span>, </span>
<span>        contour <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"density"</span>, xlab <span class="op">=</span> <span class="st">"T_water, dgC"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"S, -"</span>, clab <span class="op">=</span> <span class="st">"kg/m3"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">CPtq</span>, x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">S.seq</span>, </span>
<span>        contour <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"specific heat capacity"</span>, xlab <span class="op">=</span> <span class="st">"T_water, dgC"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"S -"</span>, clab <span class="op">=</span> <span class="st">"J/kg/dg"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">TDtq</span>, x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">S.seq</span>, </span>
<span>        contour <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"thermal diffusivity"</span>, xlab <span class="op">=</span> <span class="st">"T_water, dgC"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"S, -"</span>, clab <span class="op">=</span> <span class="st">"m2/s"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">Dtp</span>,  x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">P.seq</span><span class="op">/</span><span class="fl">1000</span>, </span>
<span>        contour <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"density"</span>, xlab <span class="op">=</span> <span class="st">"T_water, dgC"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"P, KPa"</span>, clab <span class="op">=</span> <span class="st">"kg/m3"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">CPtp</span>, x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">P.seq</span><span class="op">/</span><span class="fl">1000</span>, </span>
<span>        contour <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"specific heat capacity"</span>, xlab <span class="op">=</span> <span class="st">"T_water, dgC"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"P, KPa"</span>, clab <span class="op">=</span> <span class="st">"J/kg/dg"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>z <span class="op">=</span> <span class="va">TDtp</span>, x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">P.seq</span><span class="op">/</span><span class="fl">1000</span>, </span>
<span>        contour <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"thermal diffusivity"</span>, xlab <span class="op">=</span> <span class="st">"T_water, dgC"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"P, KPa"</span>, clab <span class="op">=</span> <span class="st">"m2/s"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>outer <span class="op">=</span> <span class="cn">TRUE</span>, side <span class="op">=</span> <span class="fl">3</span>, <span class="st">"water properties"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-22-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="reference-comparisons-1">Reference comparisons<a class="anchor" aria-label="anchor" href="#reference-comparisons-1"></a>
</h3>
<p>We compare the output of this function with a set of reference
values, for which the following sources were used: Nayar et al.,
2016</p>
<p>The water properties are estimated for a sequence of temperatures,
and for several salinity values.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T.seq</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">40</span></span>
<span><span class="va">S.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">40</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">cpVals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">S.seq</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> </span>
<span>                              <span class="fu"><a href="../reference/water_properties.html">water_cp</a></span><span class="op">(</span>S <span class="op">=</span> <span class="va">s</span>, T_water <span class="op">=</span> <span class="va">T.seq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">cpVals</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"specific heat capacity"</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"T, dgC"</span>, ylab <span class="op">=</span> <span class="st">"J/kg/dgC"</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matpoints</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cp.ref</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">cp.ref</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>          pch <span class="op">=</span> <span class="fl">18</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tcVals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">S.seq</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> </span>
<span>                              <span class="fu"><a href="../reference/water_properties.html">water_tc</a></span><span class="op">(</span>S <span class="op">=</span> <span class="va">s</span>, T_water <span class="op">=</span> <span class="va">T.seq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">tcVals</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"thermal conductivity"</span>,  </span>
<span>        xlab <span class="op">=</span> <span class="st">"T, dgC"</span>, ylab <span class="op">=</span> <span class="st">"W/m/dgC"</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matpoints</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tc.ref</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">tc.ref</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>          pch <span class="op">=</span> <span class="fl">18</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tdVals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">S.seq</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> </span>
<span>                              <span class="fu"><a href="../reference/water_properties.html">water_td</a></span><span class="op">(</span>S <span class="op">=</span> <span class="va">s</span>, T_water <span class="op">=</span> <span class="va">T.seq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">tdVals</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"thermal diffusivity"</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"T, dgC"</span>, ylab <span class="op">=</span> <span class="st">"m2/s"</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matpoints</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">td.ref</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">td.ref</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>          pch <span class="op">=</span> <span class="fl">18</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lhVals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">S.seq</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> </span>
<span>                              <span class="fu"><a href="../reference/water_properties.html">water_lh</a></span><span class="op">(</span>S <span class="op">=</span> <span class="va">s</span>, T_water <span class="op">=</span> <span class="va">T.seq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">lhVals</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"latent heat varporization"</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"T, dgC"</span>, ylab <span class="op">=</span> <span class="st">"J/kg"</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matpoints</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">lh.ref</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y<span class="op">=</span><span class="va">lh.ref</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>          pch<span class="op">=</span><span class="fl">18</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ddVals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">S.seq</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> </span>
<span>                              <span class="fu"><a href="../reference/water_properties.html">water_density</a></span><span class="op">(</span>S <span class="op">=</span> <span class="va">s</span>, T_water <span class="op">=</span> <span class="va">T.seq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">T.seq</span>, y <span class="op">=</span> <span class="va">ddVals</span>, main <span class="op">=</span> <span class="st">"density"</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"T, dgC"</span>, ylab <span class="op">=</span> <span class="st">"kg/m3"</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matpoints</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dens.ref</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">dens.ref</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>          pch <span class="op">=</span> <span class="fl">18</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html" class="external-link">plot.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"center"</span>, legend<span class="op">=</span><span class="va">S.seq</span>, title<span class="op">=</span><span class="st">"Salinity"</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-24-1.png" width="864"></p>
</div>
</div>
<div class="section level2">
<h2 id="properties-of-the-bulk-sediment">Properties of the bulk sediment<a class="anchor" aria-label="anchor" href="#properties-of-the-bulk-sediment"></a>
</h2>
<p>Using mixture formulations, functions <em>bulkDensity</em>,
<em>bulkCp</em>, and <em>bulkTd</em> calculate the density, specific
heat capacity and thermal diffusivity of the bulk sediment
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi></mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">_{bs}</annotation></semantics></math>).
For <em>bulkDensity</em> and <em>bulkCp</em>, a simple arithmetic mean
is estimated, based on the properties of the water
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi></mi><mi>w</mi></msub><annotation encoding="application/x-tex">_w</annotation></semantics></math>),
the solid phase
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi></mi><mi>s</mi></msub><annotation encoding="application/x-tex">_s</annotation></semantics></math>)
(sediment grains) and porosity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>).
For density:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><mo>=</mo><mi>ϕ</mi><mo>⋅</mo><msub><mi>ρ</mi><mi>w</mi></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><msub><mi>ρ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\rho_{bs} = \phi \cdot \rho_w + (1-\phi) \cdot \rho_s</annotation></semantics></math>
while for the specific heat capacity of the bulk sediment we have:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>p</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>ϕ</mi><mo>⋅</mo><msub><mi>ρ</mi><mi>w</mi></msub><mo>⋅</mo><mi>c</mi><msub><mi>p</mi><mi>w</mi></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><msub><mi>ρ</mi><mi>s</mi></msub><mo>⋅</mo><mi>c</mi><msub><mi>p</mi><mi>s</mi></msub></mrow><mrow><mi>ϕ</mi><mo>⋅</mo><msub><mi>ρ</mi><mi>w</mi></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><msub><mi>ρ</mi><mi>s</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">cp_{bs} = \frac{\phi \cdot \rho_w \cdot cp_w + (1-\phi) \cdot \rho_s \cdot cp_s}{\phi \cdot \rho_w + (1-\phi) \cdot \rho_s}</annotation></semantics></math></p>
<p>For thermal diffusivity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>),
the formula of Goto et al., 2017 is used:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>κ</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><mo>=</mo><mfrac><msup><mi>β</mi><mi>ϕ</mi></msup><mrow><mn>1</mn><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>ϕ</mi></mrow></mfrac><mo>⋅</mo><msubsup><mi>κ</mi><mi>w</mi><mi>ϕ</mi></msubsup><msubsup><mi>κ</mi><mi>s</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">
\kappa_{bs}=\frac{\beta^\phi}{1+(\beta-1)\cdot \phi} \cdot \kappa_w^\phi \kappa_s^{(1-\phi)}
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mfrac><mrow><msub><mi>ρ</mi><mi>w</mi></msub><mo>⋅</mo><mi>c</mi><msub><mi>p</mi><mi>w</mi></msub></mrow><mrow><msub><mi>ρ</mi><mi>s</mi></msub><mo>⋅</mo><mi>c</mi><msub><mi>p</mi><mi>s</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\beta=\frac{\rho_w \cdot cp_w}{\rho_s \cdot cp_s}</annotation></semantics></math>
The properties of the solid component can be estimated based on the
fractional composition of each mineral, using the arithmetic mean for
density and specific heat capacity, and the geometric mean for thermal
diffusivity.</p>
<div class="section level3">
<h3 id="implementation-in-r-2">implementation in R<a class="anchor" aria-label="anchor" href="#implementation-in-r-2"></a>
</h3>
<p>Functions <em>bulk_density</em>, <em>bulk_cp</em>, <em>bulk_td</em>
calculate the density, heat capacity and thermal diffusivity of the bulk
sediment respectively, while <em>bulk_properties</em> calculates all
these properties at once. They are defined as:</p>
<pre><code><span><span class="fu"><a href="../reference/bulk_properties.html">bulk_density</a></span>  <span class="op">(</span>density_water <span class="op">=</span> <span class="fl">1024</span>, density_solid <span class="op">=</span> <span class="fl">2500</span>, porosity <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/bulk_properties.html">bulk_cp</a></span>  <span class="op">(</span>density_water <span class="op">=</span> <span class="fl">1024</span>, density_solid <span class="op">=</span> <span class="fl">2500</span>, cp_water <span class="op">=</span> <span class="fl">3994</span>, </span>
<span> cp_solid <span class="op">=</span> <span class="fl">1000</span>, porosity <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/bulk_properties.html">bulk_td</a></span>  <span class="op">(</span>density_water <span class="op">=</span> <span class="fl">1024</span>, density_solid <span class="op">=</span> <span class="fl">2500</span>, cp_water <span class="op">=</span> <span class="fl">3994</span>, </span>
<span> cp_solid <span class="op">=</span> <span class="fl">1000</span>, td_water <span class="op">=</span> <span class="fl">1.4e-07</span>, td_solid <span class="op">=</span> <span class="fl">2e-06</span>, porosity <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/bulk_properties.html">bulk_properties</a></span>  <span class="op">(</span>density_water <span class="op">=</span> <span class="fl">1024</span>, density_solid <span class="op">=</span> <span class="fl">2500</span>, cp_water <span class="op">=</span> <span class="fl">3994</span>, </span>
<span> cp_solid <span class="op">=</span> <span class="fl">1000</span>, td_water <span class="op">=</span> <span class="fl">1.4e-07</span>, td_solid <span class="op">=</span> <span class="fl">2e-06</span>, tc_water <span class="op">=</span> <span class="fl">0.6</span>, </span>
<span> tc_solid <span class="op">=</span> <span class="fl">2</span>, porosity <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> </span>
<span> </span></code></pre>
<p>where <em>density_water</em>, <em>density_solid</em> are the density,
<em>cp_water</em>, <em>cp_solid</em> the specific heat capacity,
<em>td_water</em>, <em>td_solid</em>, the thermal diffusivities of the
water and solid component, and <em>porosity</em> is the volumetric
porosity.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="fu"><a href="../reference/bulk_properties.html">bulk_properties</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">description</span></span></code></pre></div>
<pre><code>         names                 description   units
1 density_bulk                bulk density   kg/m3
2      cp_bulk bulk specific heat capacity J/kg/dg
3      td_bulk    bulk thermal diffusivity    m2/s
4      tc_bulk   bulk thermal conductivity   W/m/s</code></pre>
</div>
<div class="section level3">
<h3 id="dependencies-of-bulk-properties">Dependencies of bulk properties<a class="anchor" aria-label="anchor" href="#dependencies-of-bulk-properties"></a>
</h3>
<p>The dependency of the bulk properties on the sediment density
are:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">por.seq</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.</span>,   to <span class="op">=</span>    <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">densSolid.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">2500</span>, to <span class="op">=</span> <span class="fl">2900</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">por.seq</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> </span>
<span>                     <span class="fu"><a href="../reference/bulk_properties.html">bulk_density</a></span><span class="op">(</span>porosity  <span class="op">=</span> <span class="va">p</span>, </span>
<span>                                 density_solid <span class="op">=</span> <span class="va">densSolid.seq</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">CP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">por.seq</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> </span>
<span>                     <span class="fu"><a href="../reference/bulk_properties.html">bulk_cp</a></span>     <span class="op">(</span>porosity  <span class="op">=</span> <span class="va">p</span>, </span>
<span>                                 density_solid <span class="op">=</span> <span class="va">densSolid.seq</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">TD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">por.seq</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> </span>
<span>                     <span class="fu"><a href="../reference/bulk_properties.html">bulk_td</a></span>     <span class="op">(</span>porosity  <span class="op">=</span> <span class="va">p</span>, </span>
<span>                                 density_solid <span class="op">=</span> <span class="va">densSolid.seq</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">densSolid.seq</span>, y <span class="op">=</span> <span class="va">BD</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"bulk density"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"density solid fraction, kg/m3"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"kg/m3"</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span>, las <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">densSolid.seq</span>, y <span class="op">=</span> <span class="va">CP</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"bulk specific heat capacity"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"density solid fraction, kg/m3"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"J/kg/dg"</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span>, las <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">densSolid.seq</span>, y <span class="op">=</span> <span class="va">TD</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"bulk thermal diffusivity"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"density solid fraction, kg/m3"</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"m2/s"</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span>, las <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="va">por.seq</span>, </span>
<span>       title <span class="op">=</span> <span class="st">"porosity"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-27-1.png" width="864"></p>
<p>The bulk thermal diffusivity also depends slightly on the specific
heat capacity:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">por.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">cp.seq</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">500</span>, to <span class="op">=</span> <span class="fl">800</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="va">td.por</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">por.seq</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>                   <span class="fu"><a href="../reference/bulk_properties.html">bulk_td</a></span><span class="op">(</span>porosity <span class="op">=</span> <span class="va">x</span> ,</span>
<span>                          cp_solid  <span class="op">=</span> <span class="va">cp.seq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">cp.seq</span>, y <span class="op">=</span> <span class="va">por.seq</span>, z <span class="op">=</span> <span class="va">td.por</span>, contour<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>        las <span class="op">=</span> <span class="fl">1</span>, xlab <span class="op">=</span> <span class="st">"cp, J/kg/dg"</span>, ylab <span class="op">=</span> <span class="st">"porosity"</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"Thermal diffusivity"</span>, clab <span class="op">=</span> <span class="st">"m2/s"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-28-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="properties-of-the-sediment-minerals">Properties of the sediment minerals<a class="anchor" aria-label="anchor" href="#properties-of-the-sediment-minerals"></a>
</h2>
<p>A simple function is available to estimate the thermal and physical
properties of some common sedimentary minerals.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Def_fun</span><span class="op">(</span><span class="va">mineral_properties</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="fu"><a href="../reference/mineral_properties.html">mineral_properties</a></span>  <span class="op">(</span>mineral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quartz"</span>, <span class="st">"Orthoclase"</span>, <span class="st">"Albite"</span>, <span class="st">"Anorthite"</span>, </span>
<span> <span class="st">"Calcite"</span>, <span class="st">"Muscovite"</span>, <span class="st">"Illite"</span>, <span class="st">"Smectite (montmorillonite)"</span>, </span>
<span> <span class="st">"Chlorite"</span>, <span class="st">"Pyrite"</span><span class="op">)</span><span class="op">)</span> </span>
<span> </span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Def_fun</span><span class="op">(</span><span class="va">mineral_cp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="fu"><a href="../reference/mineral_properties.html">mineral_cp</a></span>  <span class="op">(</span>mineral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quartz"</span>, <span class="st">"Orthoclase"</span>, <span class="st">"Albite"</span>, <span class="st">"Anorthite"</span>, </span>
<span> <span class="st">"Calcite"</span>, <span class="st">"Muscovite"</span>, <span class="st">"Illite"</span>, <span class="st">"Smectite (montmorillonite)"</span>, </span>
<span> <span class="st">"Chlorite"</span>, <span class="st">"Pyrite"</span><span class="op">)</span><span class="op">)</span> </span>
<span> </span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Def_fun</span><span class="op">(</span><span class="va">mineral_tc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="fu"><a href="../reference/mineral_properties.html">mineral_tc</a></span>  <span class="op">(</span>mineral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quartz"</span>, <span class="st">"Orthoclase"</span>, <span class="st">"Albite"</span>, <span class="st">"Anorthite"</span>, </span>
<span> <span class="st">"Calcite"</span>, <span class="st">"Muscovite"</span>, <span class="st">"Illite"</span>, <span class="st">"Smectite (montmorillonite)"</span>, </span>
<span> <span class="st">"Chlorite"</span>, <span class="st">"Pyrite"</span><span class="op">)</span><span class="op">)</span> </span>
<span> </span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Def_fun</span><span class="op">(</span><span class="va">mineral_td</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="fu"><a href="../reference/mineral_properties.html">mineral_td</a></span>  <span class="op">(</span>mineral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quartz"</span>, <span class="st">"Orthoclase"</span>, <span class="st">"Albite"</span>, <span class="st">"Anorthite"</span>, </span>
<span> <span class="st">"Calcite"</span>, <span class="st">"Muscovite"</span>, <span class="st">"Illite"</span>, <span class="st">"Smectite (montmorillonite)"</span>, </span>
<span> <span class="st">"Chlorite"</span>, <span class="st">"Pyrite"</span><span class="op">)</span><span class="op">)</span> </span>
<span> </span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Def_fun</span><span class="op">(</span><span class="va">mineral_density</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="fu"><a href="../reference/mineral_properties.html">mineral_density</a></span>  <span class="op">(</span>mineral <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quartz"</span>, <span class="st">"Orthoclase"</span>, <span class="st">"Albite"</span>, <span class="st">"Anorthite"</span>, </span>
<span> <span class="st">"Calcite"</span>, <span class="st">"Muscovite"</span>, <span class="st">"Illite"</span>, <span class="st">"Smectite (montmorillonite)"</span>, </span>
<span> <span class="st">"Chlorite"</span>, <span class="st">"Pyrite"</span><span class="op">)</span><span class="op">)</span> </span>
<span> </span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="fu"><a href="../reference/mineral_properties.html">mineral_properties</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">description</span></span></code></pre></div>
<pre><code>    names          description   units
1 density              density   kg/m3
2      tc thermal conductivity   W/m/s
3      td  thermal diffusivity    m2/s
4      cp        heat capacity J/kg/dg</code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mineral_properties.html">mineral_properties</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>                      mineral density    tc       td  cp
1                      Quartz    2648  7.69 3.92e-06 741
2                  Orthoclase    2570  2.32 1.28e-06 707
3                      Albite    2620  2.14 1.05e-06 776
4                   Anorthite    2760  1.68 8.17e-07 745
5                     Calcite    2710  3.59 1.62e-06 820
6                   Muscovite    2831  2.32 1.03e-06 796
7                      Illite    2660  1.85 8.61e-07 808
8  Smectite (montmorillonite)    2608  1.88 9.07e-07 795
9                    Chlorite    2800  5.15 2.25e-06 818
10                     Pyrite    5011 19.21 7.40e-06 518</code></pre>
</div>
<div class="section level2">
<h2 id="heat-exchange-fluxes">Heat exchange fluxes<a class="anchor" aria-label="anchor" href="#heat-exchange-fluxes"></a>
</h2>
<div class="section level3">
<h3 id="implementation-in-r-3">implementation in R<a class="anchor" aria-label="anchor" href="#implementation-in-r-3"></a>
</h3>
<p>Several functions estimate the heat fluxes; they are:</p>
<ul>
<li>
<em>flux_heat</em>: calculates the different contributions of the
heat budget, and the total heat flux.</li>
<li>
<em>flux_latent</em>: calculates the heat flux due to
evaporation.</li>
<li>
<em>flux_sensible</em>: calculates the heat flux due to
conduction.</li>
<li>
<em>flux_backradiation</em>: calculates the heat flux due to net
longwave radation.</li>
</ul>
<p>These functions are defined as:</p>
<pre><code><span><span class="fu"><a href="../reference/flux_heat.html">flux_heat</a></span>  <span class="op">(</span>T_air <span class="op">=</span> <span class="fl">10</span>, T_sed <span class="op">=</span> <span class="fl">11</span>, P <span class="op">=</span> <span class="fl">101325</span>, Wind <span class="op">=</span> <span class="fl">0</span>, Cloudiness <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span> Qrel <span class="op">=</span> <span class="fl">0.01</span>, em_air <span class="op">=</span> <span class="fl">0.8</span>, em_sed <span class="op">=</span> <span class="fl">0.95</span>, stanton <span class="op">=</span> <span class="fl">0.001</span>, </span>
<span> dalton <span class="op">=</span> <span class="fl">0.0014</span>, por0 <span class="op">=</span> <span class="fl">1</span>, NLR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"basic"</span>, <span class="st">"may86"</span>, <span class="st">"josey97"</span>, </span>
<span> <span class="st">"bunker76"</span>, <span class="st">"bignami95"</span><span class="op">)</span><span class="op">)</span> </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/flux_heat.html">flux_latent</a></span>  <span class="op">(</span>T_air <span class="op">=</span> <span class="fl">10</span>, T_sed <span class="op">=</span> <span class="fl">11</span>, P <span class="op">=</span> <span class="fl">101325</span>, Wind <span class="op">=</span> <span class="fl">0</span>, Qrel <span class="op">=</span> <span class="fl">0.01</span>, </span>
<span> dalton <span class="op">=</span> <span class="fl">0.0014</span>, por0 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/flux_heat.html">flux_sensible</a></span>  <span class="op">(</span>T_air <span class="op">=</span> <span class="fl">10</span>, T_sed <span class="op">=</span> <span class="fl">11</span>, P <span class="op">=</span> <span class="fl">101325</span>, Wind <span class="op">=</span> <span class="fl">0</span>, Qrel <span class="op">=</span> <span class="fl">0.01</span>, </span>
<span> stanton <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span>  <span class="op">(</span>T_air <span class="op">=</span> <span class="fl">10</span>, T_sed <span class="op">=</span> <span class="fl">11</span>, P <span class="op">=</span> <span class="fl">101325</span>, Cloudiness <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span> Qrel <span class="op">=</span> <span class="fl">0.01</span>, em_air <span class="op">=</span> <span class="fl">0.8</span>, em_sed <span class="op">=</span> <span class="fl">0.95</span>, NLR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"basic"</span>, </span>
<span> <span class="st">"may86"</span>, <span class="st">"josey97"</span>, <span class="st">"bunker76"</span>, <span class="st">"bignami95"</span><span class="op">)</span><span class="op">)</span> </span>
<span> </span></code></pre>
<pre><code>        names mean.values                      description units
1       T_air     10.0000                  air temperature   dgC
2       T_sed     11.0000             sediment temperature   dgC
3           P 101325.0000                     air pressure    Pa
4        Wind      0.0000                       wind speed   m/s
5  Cloudiness      0.5000    relative fraction cloud cover     -
6        Qrel      0.0100            relative air humidity     -
7      em_air      0.8000                emissivity of Air     -
8      em_sed      0.9500     emissivity of water/sediment     -
9      dalton      0.0014   transfer coeff for latent heat     -
10    stanton      0.0010 transfer coeff for sensible heat     -
11       por0      1.0000        surface sediment porosity     -</code></pre>
<p>where <em>NLR</em> refers to formulae for estimating the
backradiation (or net longwave radiation).</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="fu"><a href="../reference/flux_heat.html">flux_heat</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">description</span></span></code></pre></div>
<pre><code>          names                            description   units
1   evaporation                    rate of evaporation kg/m2/s
2   latent_heat  LATENT heat flux (due to evaporation)    W/m2
3 sensible_heat SENSIBLE heat flux (due to conduction)    W/m2
4 backradiation Net Longwave Radiation (backradiation)    W/m2
5         total  latentHeat+sensibleHeat+backradiation    W/m2</code></pre>
</div>
<div class="section level3">
<h3 id="heat-fluxes-as-a-function-of-temperature-and-humidity">Heat fluxes as a function of temperature and humidity<a class="anchor" aria-label="anchor" href="#heat-fluxes-as-a-function-of-temperature-and-humidity"></a>
</h3>
<p>The sensitivity of the various fluxes as a function of air
temperature, sediment temperature and air humidity is plotted:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">T.seq</span>     <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">30</span></span>
<span><span class="va">Hsensible</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_sensible</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">T.seq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">T.seq</span>, <span class="va">Hsensible</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Sensible heat exchange"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Air temperature"</span>, ylab <span class="op">=</span> <span class="st">"W/m2"</span>, </span>
<span>     type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Hlatent</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_latent</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">T.seq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">T.seq</span>, <span class="va">Hlatent</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Latent heat exchange"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Air temperature"</span>, ylab <span class="op">=</span> <span class="st">"W/m2"</span>, </span>
<span>     type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Q.seq</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, len<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">Hlatent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_latent</a></span><span class="op">(</span>Qrel <span class="op">=</span> <span class="va">Q.seq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Q.seq</span>, <span class="va">Hlatent</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Latent heat exchange"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Relative Humidity"</span>, ylab <span class="op">=</span> <span class="st">"W/m2"</span>, </span>
<span>     type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NLR1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">T.seq</span>, NLR <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">NLR2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">T.seq</span>, NLR <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">NLR3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">T.seq</span>, NLR <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">NLR4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">T.seq</span>, NLR <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">NLR5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">T.seq</span>, NLR <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">T.seq</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">NLR1</span>, <span class="va">NLR2</span>, <span class="va">NLR3</span>, <span class="va">NLR4</span>, <span class="va">NLR5</span><span class="op">)</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"NLR heat exchange"</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Air temperature"</span>, ylab <span class="op">=</span> <span class="st">"W/m2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NLR1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_sed <span class="op">=</span> <span class="va">T.seq</span>, NLR <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning in data.frame(T_air, T_sed, P, Cloudiness, Qrel, nlr, em_air, em_sed, :
row names were found from a short variable and have been discarded</code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NLR2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_sed <span class="op">=</span> <span class="va">T.seq</span>, NLR <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning in data.frame(T_air, T_sed, P, Cloudiness, Qrel, nlr, em_air, em_sed, :
row names were found from a short variable and have been discarded</code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NLR3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_sed <span class="op">=</span> <span class="va">T.seq</span>, NLR <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning in data.frame(T_air, T_sed, P, Cloudiness, Qrel, nlr, em_air, em_sed, :
row names were found from a short variable and have been discarded</code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NLR4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_sed <span class="op">=</span> <span class="va">T.seq</span>, NLR <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning in data.frame(T_air, T_sed, P, Cloudiness, Qrel, nlr, em_air, em_sed, :
row names were found from a short variable and have been discarded</code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NLR5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_sed <span class="op">=</span> <span class="va">T.seq</span>, NLR <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning in data.frame(T_air, T_sed, P, Cloudiness, Qrel, nlr, em_air, em_sed, :
row names were found from a short variable and have been discarded</code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">T.seq</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">NLR1</span>, <span class="va">NLR2</span>, <span class="va">NLR3</span>, <span class="va">NLR4</span>, <span class="va">NLR5</span><span class="op">)</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"NLR heat exchange"</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Sediment temperature"</span>, ylab <span class="op">=</span> <span class="st">"W/m2"</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NLR1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>Qrel <span class="op">=</span> <span class="va">Q.seq</span>, NLR <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">NLR2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>Qrel <span class="op">=</span> <span class="va">Q.seq</span>, NLR <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">NLR3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>Qrel <span class="op">=</span> <span class="va">Q.seq</span>, NLR <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">NLR4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>Qrel <span class="op">=</span> <span class="va">Q.seq</span>, NLR <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">NLR5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>Qrel <span class="op">=</span> <span class="va">Q.seq</span>, NLR <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">Q.seq</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">NLR1</span>, <span class="va">NLR2</span>, <span class="va">NLR3</span>, <span class="va">NLR4</span>, <span class="va">NLR5</span><span class="op">)</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"NLR heat exchange"</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Relative Humidity"</span>, ylab <span class="op">=</span> <span class="st">"W/m2"</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, lty <span class="op">=</span> <span class="fl">1</span>, </span>
<span>       legend<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"basic"</span>, <span class="st">"may86"</span>, <span class="st">"josey97"</span>, <span class="st">"bunker76"</span>, <span class="st">"bignami95"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-33-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="net-longwave-radiation-fluxes-as-a-function-of-temperature">Net longwave radiation fluxes as a function of temperature<a class="anchor" aria-label="anchor" href="#net-longwave-radiation-fluxes-as-a-function-of-temperature"></a>
</h3>
<p>The net longwave radiation fluxes are estimated for a combination of
air (<em>T_air</em>) and sediment (water) temperatures (<em>T_sed</em>),
using the various formulations and compared.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T_sed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to<span class="op">=</span><span class="fl">30</span>, length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">T_air</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to<span class="op">=</span><span class="fl">30</span>, length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NLR1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">T_sed</span>, Y <span class="op">=</span> <span class="va">T_air</span>, </span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span><span class="op">)</span> </span>
<span>                    <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">X</span>, T_sed <span class="op">=</span> <span class="va">Y</span>, NLR <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NLR2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">T_sed</span>, Y <span class="op">=</span> <span class="va">T_air</span>, </span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span><span class="op">)</span> </span>
<span>                    <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">X</span>, T_sed <span class="op">=</span> <span class="va">Y</span>, NLR <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NLR3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">T_sed</span>, Y <span class="op">=</span> <span class="va">T_air</span>, </span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span><span class="op">)</span> </span>
<span>                    <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">X</span>, T_sed <span class="op">=</span> <span class="va">Y</span>, NLR <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NLR4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">T_sed</span>, Y<span class="op">=</span><span class="va">T_air</span>, </span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span><span class="op">)</span> </span>
<span>                    <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">X</span>, T_sed <span class="op">=</span> <span class="va">Y</span>, NLR <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NLR5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">T_sed</span>, Y<span class="op">=</span><span class="va">T_air</span>, </span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span><span class="op">)</span> </span>
<span>                    <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>T_air <span class="op">=</span> <span class="va">X</span>, T_sed <span class="op">=</span> <span class="va">Y</span>, NLR <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">clim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">320</span>, <span class="fl">110</span><span class="op">)</span></span>
<span><span class="va">contour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>levels<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">50</span>,<span class="op">-</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">T_sed</span>, y <span class="op">=</span> <span class="va">T_air</span>, z <span class="op">=</span> <span class="va">NLR1</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"T_air"</span>, ylab <span class="op">=</span> <span class="st">"T_sed"</span>, clim <span class="op">=</span> <span class="va">clim</span>, </span>
<span>        contour <span class="op">=</span> <span class="va">contour</span>, main <span class="op">=</span> <span class="st">"Basic"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">T_sed</span>, y <span class="op">=</span> <span class="va">T_air</span>, z <span class="op">=</span> <span class="va">NLR2</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"T_air"</span>, ylab <span class="op">=</span> <span class="st">"T_sed"</span>, clim <span class="op">=</span> <span class="va">clim</span>, </span>
<span>        contour <span class="op">=</span> <span class="va">contour</span>, main <span class="op">=</span> <span class="st">"May, 1986"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">T_sed</span>, y <span class="op">=</span> <span class="va">T_air</span>, z <span class="op">=</span> <span class="va">NLR3</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"T_air"</span>, ylab <span class="op">=</span> <span class="st">"T_sed"</span>, clim <span class="op">=</span> <span class="va">clim</span>, </span>
<span>        contour <span class="op">=</span> <span class="va">contour</span>, main <span class="op">=</span> <span class="st">"Clark et al., 1974"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">T_sed</span>, y <span class="op">=</span> <span class="va">T_air</span>, z <span class="op">=</span> <span class="va">NLR4</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"T_air"</span>, ylab <span class="op">=</span> <span class="st">"T_sed"</span>, clim <span class="op">=</span> <span class="va">clim</span>, </span>
<span>        contour <span class="op">=</span> <span class="va">contour</span>, main <span class="op">=</span> <span class="st">"Bunker, 1976"</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">T_sed</span>, y <span class="op">=</span> <span class="va">T_air</span>, z <span class="op">=</span> <span class="va">NLR5</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"T_air"</span>, ylab <span class="op">=</span> <span class="st">"T_sed"</span>, clim <span class="op">=</span> <span class="va">clim</span>, </span>
<span>        contour <span class="op">=</span> <span class="va">contour</span>, main <span class="op">=</span> <span class="st">"Bignami et al., 1995"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NLR <span class="op">=</span> <span class="st">"Basic"</span>,   val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">NLR1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NLR <span class="op">=</span> <span class="st">"May"</span>,     val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">NLR2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NLR <span class="op">=</span> <span class="st">"Clark"</span>,   val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">NLR3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NLR <span class="op">=</span> <span class="st">"Bunker"</span>,  val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">NLR4</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NLR <span class="op">=</span> <span class="st">"Bignami"</span>, val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">NLR5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">1</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">NL</span><span class="op">$</span><span class="va">val</span><span class="op">~</span><span class="va">NL</span><span class="op">$</span><span class="va">NLR</span>, horizontal <span class="op">=</span> <span class="cn">TRUE</span>, las <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"value"</span>, ylab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">"Backradiation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-35-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="net-longwave-radiation-fluxes-as-a-function-of-cloudiness-and-humidity">Net longwave radiation fluxes as a function of cloudiness and
humidity<a class="anchor" aria-label="anchor" href="#net-longwave-radiation-fluxes-as-a-function-of-cloudiness-and-humidity"></a>
</h3>
<p>The net longwave radiation fluxes are also estimated for a
combination of cloudiness and relative humidity.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Qrel</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0</span>, to<span class="op">=</span><span class="fl">1</span>,length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">Cloud</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0</span>, to<span class="op">=</span><span class="fl">1</span>,length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NLR1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">Cloud</span>, Y <span class="op">=</span> <span class="va">Qrel</span>, </span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span> </span>
<span>                    <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>Cloud <span class="op">=</span> <span class="va">X</span>, Qrel <span class="op">=</span> <span class="va">Y</span>, NLR <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NLR2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">Cloud</span>, Y <span class="op">=</span> <span class="va">Qrel</span>, </span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span> </span>
<span>                    <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>Cloud <span class="op">=</span> <span class="va">X</span>, Qrel <span class="op">=</span> <span class="va">Y</span>, NLR <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NLR3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">Cloud</span>, Y <span class="op">=</span> <span class="va">Qrel</span>, </span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span> </span>
<span>                    <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>Cloud <span class="op">=</span> <span class="va">X</span>, Qrel <span class="op">=</span> <span class="va">Y</span>, NLR <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NLR4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">Cloud</span>, Y <span class="op">=</span> <span class="va">Qrel</span>, </span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span> </span>
<span>                    <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>Cloud <span class="op">=</span> <span class="va">X</span>, Qrel <span class="op">=</span> <span class="va">Y</span>, NLR <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">NLR5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">Cloud</span>, Y <span class="op">=</span> <span class="va">Qrel</span>, </span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span><span class="op">)</span> </span>
<span>                    <span class="fu"><a href="../reference/flux_heat.html">flux_backradiation</a></span><span class="op">(</span>Cloud <span class="op">=</span> <span class="va">X</span>, Qrel <span class="op">=</span> <span class="va">Y</span>, NLR <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">zlim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">150</span>, <span class="op">-</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">contour</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">50</span>,<span class="op">-</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cloud</span>, y <span class="op">=</span> <span class="va">Qrel</span>, z <span class="op">=</span> <span class="va">NLR1</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Cloudiness"</span>, ylab <span class="op">=</span> <span class="st">"Humidity"</span>, </span>
<span>        contour <span class="op">=</span> <span class="va">contour</span>, main <span class="op">=</span> <span class="st">"Basic"</span>, zlim <span class="op">=</span> <span class="va">zlim</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cloud</span>, y <span class="op">=</span> <span class="va">Qrel</span>, z <span class="op">=</span> <span class="va">NLR2</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Cloudiness"</span>, ylab <span class="op">=</span> <span class="st">"Humidity"</span>, </span>
<span>        contour <span class="op">=</span> <span class="va">contour</span>, main <span class="op">=</span> <span class="st">"May, 1986"</span>, zlim <span class="op">=</span> <span class="va">zlim</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cloud</span>, y <span class="op">=</span> <span class="va">Qrel</span>, z <span class="op">=</span> <span class="va">NLR3</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Cloudiness"</span>, ylab <span class="op">=</span> <span class="st">"Humidity"</span>, </span>
<span>        contour <span class="op">=</span> <span class="va">contour</span>, main <span class="op">=</span> <span class="st">"Clark et al., 1974"</span>, zlim <span class="op">=</span> <span class="va">zlim</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cloud</span>, y <span class="op">=</span> <span class="va">Qrel</span>, z <span class="op">=</span> <span class="va">NLR4</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Cloudiness"</span>, ylab <span class="op">=</span> <span class="st">"Humidity"</span>, </span>
<span>        contour <span class="op">=</span> <span class="va">contour</span>, main <span class="op">=</span> <span class="st">"Bunker, 1976"</span>, zlim <span class="op">=</span> <span class="va">zlim</span><span class="op">)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cloud</span>, y <span class="op">=</span> <span class="va">Qrel</span>, z <span class="op">=</span> <span class="va">NLR5</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"Cloudiness"</span>, ylab <span class="op">=</span> <span class="st">"Humidity"</span>, </span>
<span>        contour <span class="op">=</span> <span class="va">contour</span>, main <span class="op">=</span> <span class="st">"Bignami et al. 1995"</span>, zlim <span class="op">=</span> <span class="va">zlim</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span> <span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NLR <span class="op">=</span> <span class="st">"Basic"</span>,   val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">NLR1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NLR <span class="op">=</span> <span class="st">"May"</span>,     val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">NLR2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NLR <span class="op">=</span> <span class="st">"Clark"</span>,   val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">NLR3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NLR <span class="op">=</span> <span class="st">"Bunker"</span>,  val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">NLR4</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NLR <span class="op">=</span> <span class="st">"Bignami"</span>, val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">NLR5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">1</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">NL</span><span class="op">$</span><span class="va">val</span><span class="op">~</span><span class="va">NL</span><span class="op">$</span><span class="va">NLR</span>, </span>
<span>        horizontal <span class="op">=</span> <span class="cn">TRUE</span>, las <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"value"</span>, ylab <span class="op">=</span> <span class="st">""</span>, main <span class="op">=</span> <span class="st">"Backradiation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-37-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="data-sets-1">Data sets<a class="anchor" aria-label="anchor" href="#data-sets-1"></a>
</h2>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Forcing function data for the Oosterschelde</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">ForcingOS</span><span class="op">)</span><span class="op">$</span><span class="va">description</span> </span></code></pre></div>
<pre><code>              names   units                                         description
1              Time    time                                 time in long format
2            Second     sec                                     time in seconds
3  Watertemperature     dgC                            temperature of the water
4       Waterheight       m                           height of water above NAP
5         Windspeed     m/s                  wind speed, 10 m above the surface
6    Airtemperature     dgC                              temperature of the air
7          Dewpoint     dgC                            dewpoint air temperature
8        Cloudiness       -               fractional cover of the sky by clouds
9    Solarradiation    W/m2                                     solar radiation
10         Pressure      Pa                                        air pressure
11      Airhumidity       -  water vapor as a fraction of saturated water vapor
12             Rain cm/hour                                           rain rate</code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ForcingOS</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>                 Time Second Watertemperature Waterheight Windspeed
1 2020-01-01 00:00:00      0            5.835       -1.27         8
2 2020-01-01 01:00:00   3600            5.810       -1.47         8
3 2020-01-01 02:00:00   7200            5.693       -1.27         7
  Airtemperature Dewpoint Cloudiness Solarradiation Pressure Airhumidity Rain
1            3.8      3.5          1              0   1033.8        0.98    0
2            3.6      3.3          1              0   1033.3        0.98    0
3            4.1      3.6          1              0   1032.8        0.96    0</code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Temperature data for a station in the Oosterschelde</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DataOS</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>                 Time   Second SedimentTemperature Depth_cm
1 2020-06-10 14:00:00 13957200              22.780        3
2 2020-06-10 14:15:00 13958100              22.135        3
3 2020-06-10 14:30:00 13959000              21.685        3</code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># initial temperature profile</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">InitTempOS</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  </span></code></pre></div>
<pre><code>             x     Temp
1 5.002665e-05 4.190127
2 1.522150e-04 4.192162
3 2.587646e-04 4.194282</code></pre>
</div>
<div class="section level2">
<h2 id="the-mechanistic-model-of-sediment-temperature">The mechanistic model of sediment temperature<a class="anchor" aria-label="anchor" href="#the-mechanistic-model-of-sediment-temperature"></a>
</h2>
<p>Function <em>TempSED_run1D</em> implements the one-dimensional
mechanistic model for sediment temperature in the vertical dimension. It
is a numerical model, where the sediment is subdivided in 100 vertical
boxes. The model units are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>o</mi></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">^oC</annotation></semantics></math>.
See appendix for the model equations.</p>
<p>The function is defined as:</p>
<pre><code><span><span class="fu"><a href="../reference/TempSED_run1D.html">TempSED_run1D</a></span>  <span class="op">(</span>parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3600</span>, T_ini <span class="op">=</span> <span class="fl">10</span>, z_max <span class="op">=</span> <span class="fl">10</span>, </span>
<span> dz_1 <span class="op">=</span> <span class="fl">0.001</span>, Grid <span class="op">=</span> <span class="fu">setup.grid.1D</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>, dx.1 <span class="op">=</span> <span class="va">dz_1</span>, </span>
<span> L <span class="op">=</span> <span class="va">z_max</span><span class="op">)</span>, porosity <span class="op">=</span> <span class="fl">0.5</span>, irrigation <span class="op">=</span> <span class="fl">0</span>, f_Waterheight <span class="op">=</span> <span class="fl">0</span>, </span>
<span> f_Watertemperature <span class="op">=</span> <span class="fl">10</span>, f_Airtemperature <span class="op">=</span> <span class="fl">10</span>, f_Airhumidity <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span> f_Pressure <span class="op">=</span> <span class="fl">101325</span>, f_Solarradiation <span class="op">=</span> <span class="fl">100</span>, f_Windspeed <span class="op">=</span> <span class="fl">1</span>, </span>
<span> f_Cloudiness <span class="op">=</span> <span class="fl">0.5</span>, dependency_on_T <span class="op">=</span> <span class="cn">FALSE</span>, sedpos <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span> verbose <span class="op">=</span> <span class="cn">FALSE</span>, dtmax <span class="op">=</span> <span class="fl">3600</span><span class="op">)</span> </span>
<span> </span></code></pre>
<p>where</p>
<ul>
<li>
<em>z_max</em>, <em>dz_._1</em> are the total sediment depth and the
size of the first box, in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>,</li>
<li>
<em>porosity</em> is the sediment porosity,</li>
<li>
<em>T_ini</em> is the initial condition; times represents the output
times for the model,</li>
<li>
<em>f_Waterheight</em>, <em>f_Watertemperature</em>, the overlying
water conditions</li>
<li>
<em>f_Airtemperature</em>, <em>f_Airhumidity</em>,
<em>f_Pressure</em>, <em>f_Solarradiation</em>, <em>f_Windspeed</em>,
<em>f_Cloudiness</em> are the atmospheric conditions,</li>
<li>
<em>irrigation</em> is the sediment irrigation rate,</li>
<li>
<em>sedpos</em>, if not NULL, is a vector with sediment depths whose
temperature needs to be outputted.</li>
</ul>
<p>The forcings are either a time series, a function that takes an
argument time, or one value.</p>
<p>the following parameters can be defined in <em>parms</em>:</p>
<ul>
<li>
<em>cp_water</em>, <em>cp_solid</em> in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mi>/</mi><mi>k</mi><mi>g</mi><mi>/</mi><mi>d</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">J/kg/dg</annotation></semantics></math>,
<em>tc_water</em>, <em>tc_solid</em> in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>/</mi><mi>m</mi><mi>/</mi><mi>d</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">W/m/dg</annotation></semantics></math>
and <em>dnes_water</em>, <em>dens_solid</em> in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mi>/</mi><mi>m</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">kg/m3</annotation></semantics></math>,
is the specific heat capacity (cp..), the thermal conductivity (tc..),
and the density (dens..) for water and the solid fraction
respectively.</li>
<li>
<em>albedo_water</em>, <em>albedo_sediment</em>, <em>kd_water</em>,
<em>kd_sediment</em> are the albedo (reflectance,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>−</mo><annotation encoding="application/x-tex">-</annotation></semantics></math>)
and light extinction coefficient
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>/</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">/m</annotation></semantics></math>)
for water and sediment respectively,</li>
<li>
<em>em_water</em>, <em>em_sediment</em>, are the emissivity of air
and bulk sediment respectively,</li>
</ul>
<p>Arguments <em>porosity</em>, <em>irrigation</em> and <em>T_ini</em>
can either be one value or a function that takes as an argument the
sediment depth. <em>T_ini</em> can also be the output of a previous run,
if the model needs to be restarted.</p>
<div class="section level3">
<h3 id="model-assumptions">Model assumptions<a class="anchor" aria-label="anchor" href="#model-assumptions"></a>
</h3>
<ul>
<li>The sediment has a homogeneous composition, and there is no
distinction between heat transport in solid and liquid phase,</li>
<li>There is a distinction between flats being dry (exposed to air) and
submerged (exposed to water):
<ul>
<li>when exposed to the air then sensible, latent, and backradiation
fluxes are considered, together with absorption of solar radiation
(shortwave radiation) in the sediment.</li>
<li>when submerged, there is exchange of heat with the overlying water
by conduction, in addition to input from shortwave radiation in the
sediment; the light arriviing at the sediment-water interface depends on
water height, due to light absorption in the overlying water.</li>
</ul>
</li>
</ul>
<p>Note:</p>
<ul>
<li>no backradiation within sediment?</li>
<li>all absorbed shortwave light -&gt; heat, ie no conversion into
chemical energy</li>
</ul>
</div>
<div class="section level3">
<h3 id="model-application">Model application<a class="anchor" aria-label="anchor" href="#model-application"></a>
</h3>
<p>For all subsequent models, we impose very high resolution near the
sediment-water interface (SWI). We model up to 10 meter deep. Porosity
is a declining function from 0.9 near the SWI till 0.7 at depth.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z_max</span>    <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">dz_1</span>     <span class="op">&lt;-</span> <span class="fl">1e-4</span></span>
<span></span>
<span><span class="co"># function describing the variation of porosity (volume fraction of LIQUID) with depth</span></span>
<span><span class="va">porosity</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">por.SWI</span> <span class="op">=</span> <span class="fl">0.9</span>, <span class="va">por.deep</span> <span class="op">=</span> <span class="fl">0.7</span>, <span class="va">porcoef</span> <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span> <span class="va">por.deep</span> <span class="op">+</span> <span class="op">(</span><span class="va">por.SWI</span><span class="op">-</span><span class="va">por.deep</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">*</span><span class="va">porcoef</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="application-1-seasonal-variation---flat-continuously-exposed-to-air">Application 1: SEASONAL VARIATION - FLAT CONTINUOUSLY EXPOSED TO
AIR<a class="anchor" aria-label="anchor" href="#application-1-seasonal-variation---flat-continuously-exposed-to-air"></a>
</h3>
<p>For this run:</p>
<ul>
<li>Air temperature varies seasonally from 0 to 30
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>o</mi></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">^oC</annotation></semantics></math>
</li>
<li>Solar radiation varies from 30 to 270
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>/</mi><mi>m</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">W/m2</annotation></semantics></math>;
the daily average radiation is imposed</li>
<li>No variations within a day</li>
<li>Flats are always exposed to air</li>
</ul>
<p>Forcings for air temperature and solar radiation are inputted as a
function.</p>
<ul>
<li>temperature varies as a sine wave from 0 till 30
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>o</mi></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">^oC</annotation></semantics></math>
</li>
<li>solar radiation varies from 30 till 270
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>/</mi><mi>m</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">W/m2</annotation></semantics></math>.</li>
</ul>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fAirTempYr</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> </span>
<span>               <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">15</span>   <span class="op">+</span>  <span class="fl">15</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">86400</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span>  <span class="co"># dgC</span></span>
<span><span class="va">fSolarRadYr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> </span>
<span>               <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">150</span>  <span class="op">+</span> <span class="fl">120</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">86400</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span>  <span class="co"># W/m2</span></span></code></pre></div>
<p>After a spinup of one year, the model is run for another year,
generating output every day.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">86400</span>, by <span class="op">=</span> <span class="fl">86400</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ToutYr.ini</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TempSED_run1D.html">TempSED_run1D</a></span><span class="op">(</span></span>
<span>                        z_max            <span class="op">=</span> <span class="va">z_max</span>, </span>
<span>                        dz_1             <span class="op">=</span> <span class="va">dz_1</span>, </span>
<span>                        porosity         <span class="op">=</span> <span class="va">porosity</span>, </span>
<span>                        times            <span class="op">=</span> <span class="va">times</span>, </span>
<span>                        T_ini            <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                        f_Airtemperature <span class="op">=</span> <span class="va">fAirTempYr</span>, </span>
<span>                        f_Solarradiation <span class="op">=</span> <span class="va">fSolarRadYr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ToutYr</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TempSED_run1D.html">TempSED_run1D</a></span><span class="op">(</span></span>
<span>                        z_max            <span class="op">=</span> <span class="va">z_max</span>, </span>
<span>                        dz_1             <span class="op">=</span> <span class="va">dz_1</span>, </span>
<span>                        porosity         <span class="op">=</span> <span class="va">porosity</span>, </span>
<span>                        times            <span class="op">=</span> <span class="va">times</span>, </span>
<span>                        T_ini            <span class="op">=</span> <span class="va">ToutYr.ini</span>, </span>
<span>                        f_Airtemperature <span class="op">=</span> <span class="va">fAirTempYr</span>, </span>
<span>                        f_Solarradiation <span class="op">=</span> <span class="va">fSolarRadYr</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="plot-results">Plot results<a class="anchor" aria-label="anchor" href="#plot-results"></a>
</h4>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">T_air</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ToutYr</span>, which<span class="op">=</span><span class="st">"Airtemperature"</span><span class="op">)</span></span>
<span><span class="fu">lines2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">times</span><span class="op">/</span><span class="fl">86400</span>, y <span class="op">=</span> <span class="va">T_air</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"air temperature"</span>, </span>
<span>        colvar <span class="op">=</span> <span class="va">T_air</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Rad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ToutYr</span>, which <span class="op">=</span> <span class="st">"Solarradiation"</span><span class="op">)</span></span>
<span><span class="fu">lines2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">times</span><span class="op">/</span><span class="fl">86400</span>, y <span class="op">=</span> <span class="va">Rad</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Radiation"</span>, </span>
<span>        colvar <span class="op">=</span> <span class="va">Rad</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">image2D</span><span class="op">(</span><span class="va">ToutYr</span>, main <span class="op">=</span> <span class="st">"Temperature"</span>, xlab <span class="op">=</span> <span class="st">"days"</span>,</span>
<span>      clab <span class="op">=</span> <span class="st">"dgC"</span>, ylab <span class="op">=</span> <span class="st">"m"</span>, time_unit <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>      contour <span class="op">=</span> <span class="cn">TRUE</span>, mfrow <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/TempSED_plot.html">matplot1D</a></span><span class="op">(</span><span class="va">ToutYr</span>, </span>
<span>          subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ToutYr</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span>
<span>          mfrow <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>          main <span class="op">=</span> <span class="st">"Temperature profile"</span>, </span>
<span>          xlab <span class="op">=</span> <span class="st">"temperature"</span>, ylab <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>          type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>outer <span class="op">=</span> <span class="cn">TRUE</span>, side <span class="op">=</span> <span class="fl">3</span>, <span class="st">"Seasonal variation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-43-1.png" width="576"></p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/TempSED_plot.html">matplot0D</a></span><span class="op">(</span><span class="va">ToutYr</span>, time_unit <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>          which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Heatflux_latent"</span>, <span class="st">"Heatflux_sensible"</span>,</span>
<span>              <span class="st">"Heatflux_backrad"</span>, <span class="st">"RadiationSWI"</span>, <span class="st">"Heatflux_total"</span><span class="op">)</span>,</span>
<span>          main <span class="op">=</span> <span class="st">"Fluxes"</span>, xlab <span class="op">=</span> <span class="st">"day"</span>, ylab <span class="op">=</span> <span class="st">"W/m2"</span>, </span>
<span>          lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/TempSED_plot.html">matplot0D</a></span><span class="op">(</span><span class="va">ToutYr</span>, time_unit <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>           which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean_temperature"</span>,<span class="st">"Airtemperature"</span><span class="op">)</span>, </span>
<span>           main <span class="op">=</span> <span class="st">"Temperature"</span>, xlab <span class="op">=</span> <span class="st">"day"</span>, ylab <span class="op">=</span> <span class="st">"dg"</span>, </span>
<span>           lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>outer <span class="op">=</span> <span class="cn">TRUE</span>, side <span class="op">=</span> <span class="fl">3</span>, <span class="st">"Seasonal variation-exposed to air"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-44-1.png" width="576"></p>
</div>
</div>
<div class="section level3">
<h3 id="application-2-seasonal-variation---submerged-sediment">Application 2: SEASONAL VARIATION - SUBMERGED SEDIMENT<a class="anchor" aria-label="anchor" href="#application-2-seasonal-variation---submerged-sediment"></a>
</h3>
<ul>
<li>Water temperature varies seasonally from 2 to 18
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>o</mi></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">^oC</annotation></semantics></math>
</li>
<li>Flats always submerged</li>
</ul>
<p>Forcing functions for water temperature</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fWaterTempYr</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">+</span> <span class="fl">8</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">86400</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0</span>, to <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">86400</span>, by <span class="op">=</span> <span class="fl">86400</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ToutYr2.ini</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TempSED_run1D.html">TempSED_run1D</a></span><span class="op">(</span></span>
<span>                         z_max              <span class="op">=</span> <span class="va">z_max</span>, </span>
<span>                         dz_1               <span class="op">=</span> <span class="va">dz_1</span>, </span>
<span>                         porosity           <span class="op">=</span> <span class="va">porosity</span>, </span>
<span>                         times              <span class="op">=</span> <span class="va">times</span>, </span>
<span>                         T_ini              <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                         f_Watertemperature <span class="op">=</span> <span class="va">fWaterTempYr</span>, </span>
<span>                         f_Waterheight      <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                         f_Solarradiation   <span class="op">=</span> <span class="va">fSolarRadYr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ToutYr2</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TempSED_run1D.html">TempSED_run1D</a></span><span class="op">(</span></span>
<span>                         z_max              <span class="op">=</span> <span class="va">z_max</span>, </span>
<span>                         dz_1               <span class="op">=</span> <span class="va">dz_1</span>, </span>
<span>                         porosity           <span class="op">=</span> <span class="va">porosity</span>, </span>
<span>                         times              <span class="op">=</span> <span class="va">times</span>, </span>
<span>                         T_ini              <span class="op">=</span> <span class="va">ToutYr2.ini</span>, </span>
<span>                         f_Watertemperature <span class="op">=</span> <span class="va">fWaterTempYr</span>, </span>
<span>                         f_Waterheight      <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                         f_Solarradiation   <span class="op">=</span> <span class="va">fSolarRadYr</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="plot-results-1">Plot results<a class="anchor" aria-label="anchor" href="#plot-results-1"></a>
</h4>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Twat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ToutYr2</span>, which <span class="op">=</span> <span class="st">"Watertemperature"</span><span class="op">)</span></span>
<span><span class="fu">lines2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">times</span><span class="op">/</span><span class="fl">86400</span>, y <span class="op">=</span> <span class="va">Twat</span>, colvar <span class="op">=</span> <span class="va">Twat</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Water temperature"</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Rad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ToutYr2</span>, which <span class="op">=</span> <span class="st">"Solarradiation"</span><span class="op">)</span></span>
<span><span class="fu">lines2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">times</span><span class="op">/</span><span class="fl">86400</span>, y <span class="op">=</span> <span class="va">Rad</span>, colvar <span class="op">=</span> <span class="va">Rad</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Radiation"</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">image2D</span><span class="op">(</span><span class="va">ToutYr2</span>, time_unit <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Temperature"</span>, xlab <span class="op">=</span> <span class="st">"days"</span>,</span>
<span>        clab <span class="op">=</span> <span class="st">"dgC"</span>, ylab <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>        contour <span class="op">=</span> <span class="cn">TRUE</span>, mfrow <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning in rep(dots, length.out = n): 'x' is NULL so the result will be NULL</code></pre>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/TempSED_plot.html">matplot1D</a></span><span class="op">(</span><span class="va">ToutYr2</span>,  </span>
<span>           subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ToutYr2</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>, </span>
<span>           mfrow <span class="op">=</span> <span class="cn">NULL</span>,  </span>
<span>           main <span class="op">=</span> <span class="st">"Temperature profile"</span>, </span>
<span>           xlab <span class="op">=</span> <span class="st">"temperature"</span>, ylab <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>           type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">1</span>, col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>outer <span class="op">=</span> <span class="cn">TRUE</span>, side <span class="op">=</span> <span class="fl">3</span>, <span class="st">"Seasonal variation-submerged"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-47-1.png" width="576"></p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/TempSED_plot.html">matplot0D</a></span><span class="op">(</span><span class="va">ToutYr2</span>, time_unit <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>           which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Heatflux_convection"</span>, <span class="st">"Heatflux_backrad"</span>,</span>
<span>                     <span class="st">"RadiationSWI"</span>, <span class="st">"Heatflux_total"</span><span class="op">)</span>, </span>
<span>           main <span class="op">=</span> <span class="st">"Fluxes"</span>, ylab <span class="op">=</span> <span class="st">"W/m2"</span>, xlab <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>           lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/TempSED_plot.html">matplot0D</a></span><span class="op">(</span><span class="va">ToutYr2</span>, time_unit <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>           which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean_temperature"</span>, <span class="st">"Watertemperature"</span><span class="op">)</span>, </span>
<span>           main <span class="op">=</span> <span class="st">"Temperature"</span>, ylab <span class="op">=</span> <span class="st">"dg"</span>, xlab <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>           lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>outer <span class="op">=</span> <span class="cn">TRUE</span>, side <span class="op">=</span> <span class="fl">3</span>, <span class="st">"Seasonal variation-submerged"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-48-1.png" width="576"></p>
</div>
</div>
<div class="section level3">
<h3 id="application-3-the-oosterschelde-data">Application 3: The Oosterschelde data<a class="anchor" aria-label="anchor" href="#application-3-the-oosterschelde-data"></a>
</h3>
<ul>
<li>Water temperature, water height, meteoroligical conditions: data
series.</li>
<li>Observed data at 3 water depths</li>
</ul>
<p>Forcing functions for water temperature</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ForcingOS</span><span class="op">)</span></span></code></pre></div>
<pre><code>                 Time Second Watertemperature Waterheight Windspeed
1 2020-01-01 00:00:00      0            5.835       -1.27         8
2 2020-01-01 01:00:00   3600            5.810       -1.47         8
3 2020-01-01 02:00:00   7200            5.693       -1.27         7
4 2020-01-01 03:00:00  10800            5.628       -0.92         7
5 2020-01-01 04:00:00  14400            5.581       -0.47         6
6 2020-01-01 05:00:00  18000            5.585        0.13         6
  Airtemperature Dewpoint Cloudiness Solarradiation Pressure Airhumidity Rain
1            3.8      3.5          1              0   1033.8        0.98    0
2            3.6      3.3          1              0   1033.3        0.98    0
3            4.1      3.6          1              0   1032.8        0.96    0
4            3.9      3.3          1              0   1032.2        0.96    0
5            4.1      3.6          1              0   1031.6        0.96    0
6            4.4      3.7          1              0   1031.3        0.95    0</code></pre>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DataOS</span><span class="op">)</span></span></code></pre></div>
<pre><code>                 Time   Second SedimentTemperature Depth_cm
1 2020-06-10 14:00:00 13957200              22.780        3
2 2020-06-10 14:15:00 13958100              22.135        3
3 2020-06-10 14:30:00 13959000              21.685        3
4 2020-06-10 14:45:00 13959900              21.510        3
5 2020-06-10 15:00:00 13960800              21.085        3
6 2020-06-10 15:15:00 13961700              20.585        3</code></pre>
<p>The parameter “nap” was derived by manually tuning the model to the
data.</p>
<p>The porosity was measured and varies from 0.54 near the surface to
0.3 at depth .</p>
<p>The albedo of the sediment was set rather high (0.3) - default =
0.2.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nap</span>   <span class="op">&lt;-</span> <span class="fl">0.5</span>   <span class="co"># [m] position of the sampling above NAP</span></span>
<span></span>
<span><span class="va">WaterHeight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Time   <span class="op">=</span> <span class="va">ForcingOS</span><span class="op">$</span><span class="va">Time</span>, </span>
<span>                          height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">ForcingOS</span><span class="op">$</span><span class="va">Waterheight</span> <span class="op">+</span> <span class="va">nap</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># porosity function (varies from 0.49 to 0.54)</span></span>
<span><span class="va">por_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>  <span class="co"># x = depth in m</span></span>
<span>  <span class="fl">0.49</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0.54</span> <span class="op">-</span> <span class="fl">0.49</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span><span class="op">*</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># initial temperature: a good profile was created, and used here with approx</span></span>
<span><span class="va">Tini_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx</a></span><span class="op">(</span><span class="va">InitTempOS</span>, xout <span class="op">=</span> <span class="va">x</span>, rule <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">y</span></span>
<span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ForcingOS</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span>, </span>
<span>                       to   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ForcingOS</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span>, </span>
<span>                       by   <span class="op">=</span> <span class="fl">3600</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">OSout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TempSED_run1D.html">TempSED_run1D</a></span><span class="op">(</span></span>
<span>           times              <span class="op">=</span> <span class="va">times</span>, </span>
<span>           T_ini              <span class="op">=</span> <span class="va">Tini_fun</span>, </span>
<span>           porosity           <span class="op">=</span> <span class="va">por_fun</span>, </span>
<span>           f_Waterheight      <span class="op">=</span> <span class="va">WaterHeight</span>, </span>
<span>           f_Watertemperature <span class="op">=</span> <span class="va">ForcingOS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Watertemperature"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>           f_Solarradiation   <span class="op">=</span> <span class="va">ForcingOS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Solarradiation"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>           f_Windspeed        <span class="op">=</span> <span class="va">ForcingOS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Windspeed"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>           f_Airtemperature   <span class="op">=</span> <span class="va">ForcingOS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Airtemperature"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>           f_Cloudiness       <span class="op">=</span> <span class="va">ForcingOS</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Cloudiness"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>           parms              <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>kd_water <span class="op">=</span> <span class="fl">0.1</span>, albedo_sediment <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>           sedpos             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.06</span>, <span class="fl">0.09</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Tdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>var   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Tsed"</span>, <span class="va">DataOS</span><span class="op">$</span><span class="va">Depth_cm</span>, sep<span class="op">=</span><span class="st">"_0.0"</span><span class="op">)</span>,</span>
<span>                    time  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">DataOS</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>                    value <span class="op">=</span> <span class="va">DataOS</span><span class="op">$</span><span class="va">SedimentTemperature</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">OSout</span>, mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Tdata</span><span class="op">$</span><span class="va">var</span><span class="op">)</span>,</span>
<span>     obs <span class="op">=</span> <span class="va">Tdata</span>, obspar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="st">"."</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="TempSED_files/figure-html/unnamed-chunk-51-1.png" width="960"></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Bunker, A. F., 1976. Computations of surface energy flux and annual
air-sea interaction cycles of the North Atlantic Ocean, Mon. Weather
Rev., 104, 1122–1140.</p>
<p>Bignami, F., S. Marullo, R. Santoleri, and M.E. Schiano, 1995.
Longwave radiation budget in the Mediterranean Sea, J. Geophys. Res.,
100(C2), 2501–2514.</p>
<p>Clark, N.E., L. Eber, R.M. Laurs, J.A. Renner, and J.F.T. Saur, 1974.
Heat exchange between ocean and atmosphere in the eastern North Pacific
for 1961-71, NOAA Tech. Rep. NMFS SSRF-682, U.S. Dep. of Commer.,
Washington, D. C., 1974.</p>
<p>Josey, S.A., D. Oakley, and R.W. Pascal, 1997. On estimating the
atmospheric longwave flux at the ocean surface from ship meteorological
reports. J. Geophys. Res., 102(C13), 27961–27972.</p>
<p>Onken, R., H. Garbe, S. Schr:der, and M. Janik, 2010. A new
instrument for sediment temperature measurements. J Mar Sci Technol
15:427–-433, DOI 10.1007/s00773-010-0096-8</p>
<p>J.P. Rinehimer and J.T. Thomson, 2014. Observations and modeling of
heat fluxes on tidal flats. J. Geophys. Res.: oceans, 119, 133-–146, <a href="doi:10.1002/2013JC009225" class="uri">doi:10.1002/2013JC009225</a></p>
<p>T.-W. Kim,1 Yang-Ki Cho and E.P. Dever, 2007. An evaluation of the
thermal properties and albedo of a macrotidal flat. J. Geophys. Res.,
112 (C12009), <a href="doi:10.1029/2006JC004015" class="uri">doi:10.1029/2006JC004015</a>.</p>
<div style="page-break-after: always;"></div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<p>The temperature equation, describing the temperature in the bulk
sediment,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">T_{bs}</annotation></semantics></math>,
in 1D, is given by the diffusion-reaction equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mrow><mi>c</mi><msub><mi>p</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><msub><mi>ρ</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub></mrow></mfrac><mfrac><mi>∂</mi><mrow><mi>∂</mi><mi>x</mi></mrow></mfrac><msub><mi>K</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><mfrac><mrow><mi>∂</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub></mrow><mrow><mi>∂</mi><mi>x</mi></mrow></mfrac><mo>−</mo><mfrac><mn>1</mn><mrow><mi>c</mi><msub><mi>p</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><mo>⋅</mo><msub><mi>ρ</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mi>∂</mi><msub><mi>I</mi><mi>x</mi></msub></mrow><mrow><mi>∂</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\frac{\partial T_{bs}}{\partial t} = \frac{1}{cp_{bs}\rho_{bs}}\frac{\partial }{\partial x}K_{bs} \frac{\partial T_{bs}}{\partial x}-\frac{1}{cp_{bs} \cdot \rho_{bs}}\frac{\partial I_x}{\partial x}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">K_{bs}</annotation></semantics></math>
is the thermal conductivity of the bulk
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>/</mi><mi>m</mi><mi>/</mi><mi>d</mi><mi>g</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">W/m/dgC</annotation></semantics></math>),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>p</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">cp_{bs}</annotation></semantics></math>
is the bulk specific heat capacity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mi>/</mi><mi>k</mi><mi>g</mi><mi>/</mi><mi>d</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">J/kg/dg</annotation></semantics></math>),
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\rho_{bs}</annotation></semantics></math>
is the bulk density
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mi>/</mi><mi>m</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">kg/m3</annotation></semantics></math>).</p>
<p>with boundary conditions</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub></mrow><mrow><mi>∂</mi><mi>x</mi></mrow></mfrac><msub><mo stretchy="false" form="prefix">|</mo><mrow><mi>x</mi><mo>=</mo><mi>∞</mi></mrow></msub><mo>=</mo><mn>0</mn><mo>,</mo></mrow><annotation encoding="application/x-tex">
\frac{\partial T_{bs}}{\partial x}|_{x=\infty} = 0,
</annotation></semantics></math> at the lower boundary, and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><mo>⋅</mo><mfrac><mrow><mi>∂</mi><msub><mi>T</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub></mrow><mrow><mi>∂</mi><mi>x</mi></mrow></mfrac><msub><mo stretchy="false" form="prefix">|</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow></msub><mo>=</mo><msub><mi>H</mi><mn>0</mn></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
K _{bs} \cdot \frac{\partial T_{bs}}{\partial x}|_{x=0} =  H_0,
</annotation></semantics></math> at the upper boundary, when exposed to
the air, or
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><msub><mo stretchy="false" form="prefix">|</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow></msub><mo>=</mo><msub><mi>T</mi><mrow><mi>o</mi><mi>w</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
T_{bs}|_{x=0}=T_{ow},
</annotation></semantics></math> When exposed to the water.</p>
<p>Imposed settings</p>
<table class="table">
<colgroup>
<col width="4%">
<col width="41%">
<col width="46%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th>variable</th>
<th>description</th>
<th>default value</th>
<th>units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math></td>
<td>sediment depth</td>
<td></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>a</mi></msub><annotation encoding="application/x-tex">T_a</annotation></semantics></math></td>
<td>air temperature</td>
<td>10</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>o</mi></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">^o C</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>w</mi></msub><annotation encoding="application/x-tex">T_w</annotation></semantics></math></td>
<td>temperature of overlying water (d &gt; 0)</td>
<td>10</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>o</mi></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">^o C</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math></td>
<td>water depth</td>
<td>0</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>a</mi></msub><annotation encoding="application/x-tex">I_a</annotation></semantics></math></td>
<td>incident solar radiation</td>
<td>100</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>/</mi><mi>m</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">W/m2</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>U</mi><annotation encoding="application/x-tex">U</annotation></semantics></math></td>
<td>wind speed</td>
<td>1</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>/</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">m/s</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math></td>
<td>air pressure</td>
<td>101325</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">Pa</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math></td>
<td>fractional cloud cover</td>
<td>0.5</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>−</mo><annotation encoding="application/x-tex">-</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mi>r</mi></msub><annotation encoding="application/x-tex">Q_r</annotation></semantics></math></td>
<td>relative humidity of the air</td>
<td>0.3</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>−</mo><annotation encoding="application/x-tex">-</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>Bulk formulations used</p>
<table class="table">
<colgroup>
<col width="4%">
<col width="41%">
<col width="46%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th>variable</th>
<th>description</th>
<th>formula</th>
<th>units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">T_{bs}</annotation></semantics></math></td>
<td>bulk temperature</td>
<td>state variable</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>o</mi></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">^o C</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">K_{bs}</annotation></semantics></math></td>
<td>bulk thermal conductivity</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>K</mi><mi>w</mi><mi>ϕ</mi></msubsup><mo>⋅</mo><msubsup><mi>K</mi><mi>s</mi><mrow><mn>1</mn><mo>−</mo><mi>ϕ</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">K_w^\phi\cdot K_s^{1-\phi}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mn>2</mn></msup><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">m^2 s^{-1}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\rho_{bs}</annotation></semantics></math></td>
<td>bulk density</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><msub><mi>ρ</mi><mi>w</mi></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>r</mi><mi>h</mi><msub><mi>o</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\phi \rho_{w} + (1-\phi)rho_{s}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">kg m^{-3}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>p</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">cp_{bs}</annotation></semantics></math></td>
<td>bulk specific heat capacity</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>ϕ</mi><msub><mi>ρ</mi><mi>w</mi></msub><mi>c</mi><msub><mi>p</mi><mi>w</mi></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ρ</mi><mi>s</mi></msub><mi>c</mi><msub><mi>p</mi><mi>s</mi></msub></mrow><msub><mi>ρ</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub></mfrac><annotation encoding="application/x-tex">\frac{\phi \rho_w cp_{w} + (1-\phi) \rho_s cp_{s}}{\rho_{bs}}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mspace width="0.222em"></mspace><mi>k</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mspace width="0.222em"></mspace><msup><mrow><msup><mi></mi><mi>o</mi></msup><mi>K</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">J~kg^{-1}~{^o K}^{-1}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>Heat formulations used</p>
<table class="table">
<colgroup>
<col width="4%">
<col width="41%">
<col width="46%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th>variable</th>
<th>description</th>
<th>formula</th>
<th>units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>x</mi></msub><annotation encoding="application/x-tex">I_x</annotation></semantics></math></td>
<td>shortwave radiation at depth
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>0</mn></msub><mo>⋅</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>k</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><mo>⋅</mo><mi>x</mi></mrow></msup></mrow><annotation encoding="application/x-tex">I_{0} \cdot e^{-k_{bs} \cdot x}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">W m^{-2}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mn>0</mn></msub><annotation encoding="application/x-tex">I_{0}</annotation></semantics></math></td>
<td>shortwave radiation at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=0</annotation></semantics></math>
-exposed</td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>a</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I_a \cdot (1-\alpha_s)</annotation></semantics></math>
(exposed)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">W m^{-2}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td></td>
<td>shortwave radiation at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=0</annotation></semantics></math>
-submerged</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>a</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>w</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>k</mi><mi>w</mi></msub><mo>⋅</mo><mi>d</mi></mrow></msup></mrow><annotation encoding="application/x-tex">I_a \cdot (1-\alpha_w) \cdot (1-\alpha_s) \cdot e^{-k_w\cdot d}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">W m^{-2}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math></td>
<td>total heat input into the sediment</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>l</mi></msub><mo>+</mo><msub><mi>H</mi><mi>h</mi></msub><mo>+</mo><msub><mi>H</mi><mi>e</mi></msub><mo>−</mo><msub><mi>H</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">H_l + H_h + H_e - H_w</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">W m^{-2}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>l</mi></msub><annotation encoding="application/x-tex">H_l</annotation></semantics></math></td>
<td>net longwave radiation (backradiation)</td>
<td>see table</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">W m^{-2}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>h</mi></msub><annotation encoding="application/x-tex">H_h</annotation></semantics></math></td>
<td>sensible heat flux (~ conduction)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><msub><mi>ρ</mi><mi>a</mi></msub><mo>⋅</mo><mi>c</mi><msub><mi>p</mi><mi>a</mi></msub><mo>⋅</mo><msub><mi>C</mi><mi>h</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>s</mi></msub><mo>−</mo><msub><mi>T</mi><mi>a</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">- \rho_a \cdot cp_a \cdot C_h \cdot(U+1)\cdot (T_s-T_a)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">W m^{-2}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mi>e</mi></msub><annotation encoding="application/x-tex">l_e</annotation></semantics></math></td>
<td>latent heat of evaporation</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>2500.8</mn><mo>−</mo><mn>2.37</mn><mo>⋅</mo><msub><mi>T</mi><mi>s</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mn>1000</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(2500.8-2.37 \cdot T_s)\cdot 1000)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mspace width="0.222em"></mspace><mi>k</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">J~kg^{-1}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>e</mi></msub><annotation encoding="application/x-tex">E_e</annotation></semantics></math></td>
<td>Evaporation rate</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>⋅</mo><msub><mi>ρ</mi><mi>a</mi></msub><mo>⋅</mo><msub><mi>C</mi><mi>e</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>U</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Q</mi><mi>s</mi><mi>s</mi></msubsup><mo>−</mo><msub><mi>Q</mi><mi>a</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\phi \cdot \rho_a \cdot C_e \cdot (U+1)\cdot (Q^s_s-Q_a)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mspace width="0.222em"></mspace><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mspace width="0.222em"></mspace><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">kg~m^{-2}~s^{-1}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>e</mi></msub><annotation encoding="application/x-tex">H_e</annotation></semantics></math></td>
<td>latent heat flux (due to evaporation)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><msub><mi>E</mi><mi>e</mi></msub><mo>⋅</mo><msub><mi>l</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">- E_e \cdot l_e</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">W m^{-2}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>w</mi></msub><annotation encoding="application/x-tex">H_w</annotation></semantics></math></td>
<td>heat exchange with the overlying water</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>κ</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><mo>⋅</mo><mfrac><mrow><mi>∂</mi><msub><mi>T</mi><mi>s</mi></msub></mrow><mrow><mi>∂</mi><mi>x</mi></mrow></mfrac><msub><mo stretchy="false" form="prefix">|</mo><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\kappa _{bs} \cdot \frac{\partial T_s}{\partial x}|_{x=0}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">W m^{-2}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>Forcing functions</p>
<table class="table">
<colgroup>
<col width="4%">
<col width="41%">
<col width="46%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th>variable</th>
<th>description</th>
<th>formula</th>
<th>units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><msub><mi>K</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">TK_a</annotation></semantics></math></td>
<td>air temperature</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>a</mi></msub><mo>+</mo><mn>273.15</mn></mrow><annotation encoding="application/x-tex">T_a +273.15</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>o</mi></msup><mi>K</mi></mrow><annotation encoding="application/x-tex">^o K</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><msub><mi>K</mi><mrow><mi>b</mi><mi>s</mi><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">TK_{bs0}</annotation></semantics></math></td>
<td>surface sediment temperature</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>b</mi><mi>s</mi><mn>0</mn></mrow></msub><mo>+</mo><mn>273.15</mn></mrow><annotation encoding="application/x-tex">T_{bs0} +273.15</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi></mi><mi>o</mi></msup><mi>K</mi></mrow><annotation encoding="application/x-tex">^o K</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>p</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">cp_a</annotation></semantics></math></td>
<td>specific heat of moist air</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1005</mn><mo>+</mo><mn>1.82</mn><mo>*</mo><msub><mi>Q</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">1005 + 1.82*Q_r</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mspace width="0.222em"></mspace><mi>k</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mspace width="0.222em"></mspace><msup><mrow><msup><mi></mi><mi>o</mi></msup><mi>K</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">J~kg^{-1}~{^o K}^{-1}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Q</mi><mi>s</mi><mi>s</mi></msubsup><annotation encoding="application/x-tex">Q^s_s</annotation></semantics></math></td>
<td>specific humidity of saturated air at sediment temperature
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>s</mi></msub><annotation encoding="application/x-tex">T_s</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>m</mi><mi>w</mi><mi>r</mi><mo>⋅</mo><msubsup><mi>P</mi><mi>s</mi><mi>s</mi></msubsup></mrow><mrow><mi>P</mi><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>m</mi><mi>w</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><msubsup><mi>P</mi><mi>s</mi><mi>s</mi></msubsup></mrow></mfrac><annotation encoding="application/x-tex">\frac{mwr \cdot P^s_s}{P-(1-mwr) \cdot P^s_s}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mspace width="0.222em"></mspace><mi>k</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">kg~kg^{-1}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Q</mi><mi>a</mi><mi>s</mi></msubsup><annotation encoding="application/x-tex">Q^s_a</annotation></semantics></math></td>
<td>specific humidity of saturated air at air temperature
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>a</mi></msub><annotation encoding="application/x-tex">T_a</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>m</mi><mi>w</mi><mi>r</mi><mo>⋅</mo><msubsup><mi>P</mi><mi>a</mi><mi>s</mi></msubsup></mrow><mrow><mi>P</mi><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>m</mi><mi>w</mi><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mi>P</mi><mi>a</mi><mi>s</mi></msubsup></mrow></mfrac><annotation encoding="application/x-tex">\frac{mwr \cdot P^s_a}{P-(1-mwr) P^s_a}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mspace width="0.222em"></mspace><mi>k</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">kg~kg^{-1}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mi>a</mi></msub><annotation encoding="application/x-tex">Q_a</annotation></semantics></math></td>
<td>specific humidity of the air at air temperature
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>a</mi></msub><annotation encoding="application/x-tex">T_a</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Q</mi><mi>a</mi><mi>s</mi></msubsup><mo>⋅</mo><msub><mi>Q</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">Q^s_a \cdot Q_r</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mspace width="0.222em"></mspace><mi>k</mi><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">kg~kg^{-1}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>P</mi><mi>s</mi><mi>s</mi></msubsup><annotation encoding="application/x-tex">P^s_s</annotation></semantics></math></td>
<td>saturated vapor pressure at sediment temperature
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>s</mi></msub><annotation encoding="application/x-tex">T_s</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>⋅</mo><msubsup><mi>a</mi><mn>1</mn><mn>5.02808</mn></msubsup><mo>*</mo><msup><mn>10</mn><mrow><mo>−</mo><msub><mi>a</mi><mn>2</mn></msub><mo>⋅</mo><mn>7.90298</mn></mrow></msup><mo>+</mo><msub><mi>a</mi><mn>4</mn></msub><mo>⋅</mo><mn>8.1328</mn><msup><mi>e</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup><mo>−</mo><msub><mi>a</mi><mn>5</mn></msub><mo>⋅</mo><mn>1.3816</mn><msup><mi>e</mi><mrow><mo>−</mo><mn>7</mn></mrow></msup></mrow><annotation encoding="application/x-tex">P \cdot a_1^{5.02808}*10^{-a_2\cdot 7.90298} +a_4 \cdot 8.1328e^{-3} -a_5 \cdot 1.3816 e ^{-7}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">Pa</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>P</mi><mi>a</mi><mi>s</mi></msubsup><annotation encoding="application/x-tex">P^s_a</annotation></semantics></math></td>
<td>saturated vapor pressure at air temperature
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>a</mi></msub><annotation encoding="application/x-tex">T_a</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>⋅</mo><msubsup><mi>a</mi><mn>1</mn><mn>5.02808</mn></msubsup><mo>*</mo><msup><mn>10</mn><mrow><mo>−</mo><msub><mi>a</mi><mn>2</mn></msub><mo>⋅</mo><mn>7.90298</mn></mrow></msup><mo>+</mo><msub><mi>a</mi><mn>4</mn></msub><mo>⋅</mo><mn>8.1328</mn><msup><mi>e</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup><mo>−</mo><msub><mi>a</mi><mn>5</mn></msub><mo>⋅</mo><mn>1.3816</mn><msup><mi>e</mi><mrow><mo>−</mo><mn>7</mn></mrow></msup></mrow><annotation encoding="application/x-tex">P \cdot a_1^{5.02808}*10^{-a_2\cdot 7.90298} +a_4 \cdot 8.1328e^{-3} -a_5 \cdot 1.3816e^{-7}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">Pa</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>=</mo><mn>373.16</mn><mi>/</mi><msub><mi>K</mi><mrow><mi>s</mi><mo>,</mo><mi>a</mi></mrow></msub><mspace width="0.222em"></mspace><mo>;</mo><mspace width="1.0em"></mspace><msub><mi>a</mi><mn>2</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mspace width="0.222em"></mspace><mo>;</mo><mspace width="1.0em"></mspace><msub><mi>a</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn><mo>−</mo><mn>1</mn><mi>/</mi><msub><mi>a</mi><mn>1</mn></msub><mspace width="0.222em"></mspace><mo>;</mo><mspace width="1.0em"></mspace><msub><mi>a</mi><mn>4</mn></msub><mo>=</mo><msup><mn>10</mn><mrow><mo>−</mo><msub><mi>a</mi><mn>2</mn></msub><mo>⋅</mo><mn>3.49149</mn></mrow></msup><mo>−</mo><mn>1</mn><mspace width="0.222em"></mspace><mo>;</mo><mspace width="1.0em"></mspace><msub><mi>a</mi><mn>5</mn></msub><mo>=</mo><msup><mn>10</mn><mrow><msub><mi>a</mi><mn>3</mn></msub><mo>⋅</mo><mn>11.344</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a_1 = 373.16/K_{s,a}~;\quad a_2 = a_1-1~;\quad a_3 = 1 - 1/a_1~;\quad a_4 = 10^{-a_2 \cdot 3.49149}-1~;\quad a_5 = 10^ {a_3 \cdot 11.344} -1</annotation></semantics></math></td>
<td></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>v</mi></msub><annotation encoding="application/x-tex">P_v</annotation></semantics></math></td>
<td>vapor pressure of air</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mi>a</mi><mi>s</mi></msubsup><mo>⋅</mo><msub><mi>Q</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">P^s_a \cdot Q_r</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">Pa</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>d</mi></msub><annotation encoding="application/x-tex">P_d</annotation></semantics></math></td>
<td>pressure of dry air</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>−</mo><msub><mi>P</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">P - P_v</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">Pa</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>a</mi></msub><annotation encoding="application/x-tex">\rho_{a}</annotation></semantics></math></td>
<td>air density</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mo>⋅</mo><mfrac><mrow><msub><mi>P</mi><mi>d</mi></msub><mi>/</mi><msub><mi>R</mi><mi>d</mi></msub><mo>+</mo><msub><mi>P</mi><mi>v</mi></msub><mi>/</mi><msub><mi>R</mi><mi>v</mi></msub></mrow><mrow><mi>T</mi><msub><mi>K</mi><mi>a</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">10\cdot \frac{P_d/R_d + P_v/R_v}{TK_a}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mspace width="0.222em"></mspace><msup><mi>m</mi><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">kg ~m^{-3}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>Summary of formulate to estimate the net longwave heat flux
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mi>l</mi></msub><annotation encoding="application/x-tex">Q_l</annotation></semantics></math>:</p>
<table class="table">
<colgroup>
<col width="54%">
<col width="32%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th>Formula for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mi>l</mi></msub><annotation encoding="application/x-tex">Q_l</annotation></semantics></math>
</th>
<th>parameters</th>
<th>reference</th>
</tr></thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>σ</mi><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ϵ</mi><mi>s</mi></msub><mi>T</mi><msubsup><mi>K</mi><mrow><mi>b</mi><mi>s</mi><mn>0</mn></mrow><mn>4</mn></msubsup><mo>−</mo><msub><mi>ϵ</mi><mi>a</mi></msub><mi>T</mi><msubsup><mi>K</mi><mi>a</mi><mn>4</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">-\sigma \cdot (\epsilon_s TK_{bs0}^4 - \epsilon_a TK_a^4)</annotation></semantics></math></td>
<td></td>
<td>basic formula</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><msub><mi>ϵ</mi><mi>a</mi></msub><mi>σ</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>T</mi><msubsup><mi>K</mi><mi>a</mi><mn>4</mn></msubsup><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><msqrt><mrow><msub><mi>P</mi><mi>v</mi></msub><mi>/</mi><mn>10</mn></mrow></msqrt><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mn>4</mn><msub><mi>ϵ</mi><mi>a</mi></msub><mi>σ</mi><mi>T</mi><msubsup><mi>K</mi><mi>a</mi><mn>3</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><msub><mi>K</mi><mrow><mi>b</mi><mi>s</mi><mn>0</mn></mrow></msub><mo>−</mo><mi>T</mi><msub><mi>K</mi><mi>a</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">]</mo><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>3</mn></msub><mo>−</mo><msub><mi>x</mi><mn>4</mn></msub><msup><mi>C</mi><mi>n</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">-\epsilon_a \sigma [TK_a^4(x_1-x_2 \sqrt{P_v/10}] +4\epsilon_a \sigma TK_a^3(TK_{bs0}-TK_a)]\cdot(x_3-x_4 C^n)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>0.4</mn><mo>;</mo><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>0.05</mn><mo>;</mo><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn><mo>;</mo><msub><mi>x</mi><mn>4</mn></msub><mo>=</mo><mn>0.8</mn><mo>;</mo><mi>n</mi><mo>=</mo><mn>3.4</mn></mrow><annotation encoding="application/x-tex">x_1=0.4; x_2=0.05; x_3=1; x_4=0.8; n=3.4</annotation></semantics></math></td>
<td>May et al., 1986</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><msub><mi>ϵ</mi><mi>a</mi></msub><mi>σ</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>T</mi><msubsup><mi>K</mi><mi>a</mi><mn>4</mn></msubsup><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><msqrt><mrow><msub><mi>P</mi><mi>v</mi></msub><mi>/</mi><mn>10</mn></mrow></msqrt><mo stretchy="true" form="postfix">]</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>3</mn></msub><mo>−</mo><msub><mi>x</mi><mn>4</mn></msub><msup><mi>C</mi><mi>n</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>4</mn><msub><mi>ϵ</mi><mi>a</mi></msub><mi>σ</mi><mi>T</mi><msubsup><mi>K</mi><mi>a</mi><mn>3</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><msub><mi>K</mi><mrow><mi>b</mi><mi>s</mi><mn>0</mn></mrow></msub><mo>−</mo><mi>T</mi><msub><mi>K</mi><mi>a</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">-\epsilon_a \sigma [TK_a^4(x_1-x_2 \sqrt{P_v/10}]\cdot(x_3-x_4 C^n) +4\epsilon_a \sigma TK_a^3(TK_{bs0}-TK_a)]</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>0.39</mn><mo>;</mo><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>0.05</mn><mo>;</mo><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn><mo>;</mo><msub><mi>x</mi><mn>4</mn></msub><mo>=</mo><mn>0.8</mn><mo>;</mo><mi>n</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">x_1=0.39; x_2=0.05; x_3=1; x_4=0.8; n=2</annotation></semantics></math></td>
<td>Clark et al., 1974</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><msub><mi>ϵ</mi><mi>a</mi></msub><mi>σ</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>T</mi><msubsup><mi>K</mi><mi>a</mi><mn>4</mn></msubsup><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⋅</mo><msub><mi>P</mi><mi>v</mi></msub><mi>/</mi><mn>10</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>3</mn></msub><mo>−</mo><msub><mi>x</mi><mn>4</mn></msub><msup><mi>C</mi><mi>n</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>4</mn><msub><mi>ϵ</mi><mi>a</mi></msub><mi>σ</mi><mi>T</mi><msubsup><mi>K</mi><mi>a</mi><mn>3</mn></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><msub><mi>K</mi><mrow><mi>b</mi><mi>s</mi><mn>0</mn></mrow></msub><mo>−</mo><mi>T</mi><msub><mi>K</mi><mi>a</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">-\epsilon_a \sigma [TK_a^4(x_1-x_2 \cdot P_v/10]\cdot(x_3-x_4 C^n) +4\epsilon_a \sigma TK_a^3(TK_{bs0}-TK_a)]</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>0.254</mn><mo>;</mo><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>0.00495</mn><mo>;</mo><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn><mo>;</mo><msub><mi>x</mi><mn>4</mn></msub><mo>=</mo><mn>0.75</mn><mo>;</mo><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_1=0.254; x_2=0.00495; x_3=1; x_4=0.75; n=1</annotation></semantics></math></td>
<td>Bunker 1976</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><msub><mi>ϵ</mi><mi>w</mi></msub><mi>σ</mi><mi>T</mi><msubsup><mi>K</mi><mrow><mi>b</mi><mi>s</mi><mn>0</mn></mrow><mn>4</mn></msubsup><mo>+</mo><mi>σ</mi><mo>⋅</mo><mi>T</mi><msubsup><mi>K</mi><mi>a</mi><mn>4</mn></msubsup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⋅</mo><msub><mi>P</mi><mi>v</mi></msub><mi>/</mi><mn>10</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msub><mi>x</mi><mn>4</mn></msub><msup><mi>C</mi><mi>n</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">-\epsilon_w \sigma TK_{bs0}^4+\sigma \cdot TK_a^4\cdot(x_1+x_2 \cdot P_v/10)\cdot(1+x_4 C^n)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>0.653</mn><mo>;</mo><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>0.00535</mn><mo>;</mo><msub><mi>x</mi><mn>4</mn></msub><mo>=</mo><mn>0.1762</mn><mo>;</mo><mi>n</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">x_1=0.653; x_2=0.00535; x_4=0.1762; n=2</annotation></semantics></math></td>
<td>Bignami et al 1995</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col width="15%">
<col width="42%">
<col width="18%">
<col width="24%">
</colgroup>
<thead><tr class="header">
<th>parameter</th>
<th>description</th>
<th>default</th>
<th>units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>p</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">cp_w</annotation></semantics></math></td>
<td>heat capacity of water</td>
<td>3994</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mi>/</mi><mi>k</mi><mi>g</mi><msup><mi>/</mi><mi>o</mi></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">J/kg/^oC</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msub><mi>p</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">cp_s</annotation></semantics></math></td>
<td>heat capacity of pure sediment</td>
<td>1000</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mi>/</mi><mi>k</mi><mi>g</mi><msup><mi>/</mi><mi>o</mi></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">J/kg/^oC</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math></td>
<td>sediment porosity</td>
<td>0.5
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>*</mo></msup><annotation encoding="application/x-tex">^*</annotation></semantics></math>
</td>
<td>-</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>w</mi></msub><annotation encoding="application/x-tex">k_w</annotation></semantics></math></td>
<td>thermal conductivity of water</td>
<td>??</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>/</mi><mi>m</mi><msup><mi>/</mi><mi>o</mi></msup><mi>K</mi></mrow><annotation encoding="application/x-tex">W/m/^o K</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>s</mi></msub><annotation encoding="application/x-tex">k_s</annotation></semantics></math></td>
<td>thermal conductivity of sediment</td>
<td>??</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>/</mi><mi>m</mi><msup><mi>/</mi><mi>o</mi></msup><mi>K</mi></mrow><annotation encoding="application/x-tex">W/m/^o K</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>w</mi></msub><annotation encoding="application/x-tex">\rho_w</annotation></semantics></math></td>
<td>water density</td>
<td>1024</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mi>/</mi><mi>m</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">kg/m3</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\rho_s</annotation></semantics></math></td>
<td>sediment dry density</td>
<td>2500</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi><mi>/</mi><mi>m</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">kg/m3</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">k_{bs}</annotation></semantics></math></td>
<td>light extinction coefficient of bulk sediment</td>
<td>1000
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>*</mo></msup><annotation encoding="application/x-tex">^*</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>/</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">/m</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>w</mi></msub><annotation encoding="application/x-tex">k_w</annotation></semantics></math></td>
<td>light extinction coefficient of water</td>
<td>1
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>*</mo></msup><annotation encoding="application/x-tex">^*</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>/</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">/m</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\alpha_s</annotation></semantics></math></td>
<td>the albedo of sediment</td>
<td>0.15
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>*</mo></msup><annotation encoding="application/x-tex">^*</annotation></semantics></math>
</td>
<td>-</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>w</mi></msub><annotation encoding="application/x-tex">\alpha_w</annotation></semantics></math></td>
<td>the albedo of water</td>
<td>0.05
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>*</mo></msup><annotation encoding="application/x-tex">^*</annotation></semantics></math>
</td>
<td>-</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mi>a</mi></msub><annotation encoding="application/x-tex">\epsilon_a</annotation></semantics></math></td>
<td>emissivity of the air</td>
<td>0.8</td>
<td>-</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\epsilon_s</annotation></semantics></math></td>
<td>emissivity of the sediment</td>
<td>0.95</td>
<td>-</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></td>
<td>Stefan-Boltzmann constant</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5.67</mn><mo>×</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">5.67 \times 10^{-8}</annotation></semantics></math></td>
<td>W
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mspace width="0.222em"></mspace><msup><mi>K</mi><mrow><mo>−</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">m^{- 2}~ { K}^{-4}</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>h</mi></msub><annotation encoding="application/x-tex">C_h</annotation></semantics></math></td>
<td>bulk transfer coefficient for conduction (stanton number)</td>
<td>0.001</td>
<td>-</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>e</mi></msub><annotation encoding="application/x-tex">C_e</annotation></semantics></math></td>
<td>bulk transfer coefficient for evaporation (dalton number)</td>
<td>0.0014</td>
<td>-</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>d</mi></msub><annotation encoding="application/x-tex">R_d</annotation></semantics></math></td>
<td>specific gas ct for dry air</td>
<td>287.05,</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mi>/</mi><mi>k</mi><mi>g</mi><mi>/</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">J/kg/K</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>v</mi></msub><annotation encoding="application/x-tex">R_v</annotation></semantics></math></td>
<td>specific gas ct for water vapour</td>
<td>461.495</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mi>/</mi><mi>k</mi><mi>g</mi><mi>/</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">J/kg/K</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>w</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">mwr</annotation></semantics></math></td>
<td>mol weight water/mol weight dry air</td>
<td>0.622</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>−</mo><annotation encoding="application/x-tex">-</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="references-1">References<a class="anchor" aria-label="anchor" href="#references-1"></a>
</h2>
<p>Shusaku Goto, Makoto Yamano, Sumito Morita, Toshiya Kanamatsu,
Akihiro Hachikubo, Satsuki Kataoka, Manabu Tanahashi, Ryo Matsumoto,
2017. Physical and thermal properties of mud-dominant sediment from the
Joetsu Basin in the eastern margin of the Japan Sea. Mar Geophys Res
38:393–407, DOI 10.1007/s11001-017-9302-y</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Karline Soetaert.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
